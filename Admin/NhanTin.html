<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Messenger</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .message-bubble {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .typing-indicator {
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 1; }
        }
        .call-animation {
            animation: callPulse 2s infinite;
        }
        @keyframes callPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        .messenger-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .chat-search-highlight {
            background-color: #fef3c7;
            padding: 2px 4px;
            border-radius: 4px;
        }
        .file-upload-area {
            border: 2px dashed #d1d5db;
            transition: all 0.3s ease;
        }
        .file-upload-area:hover {
            border-color: #3b82f6;
            background-color: #f8fafc;
        }/* Panel info overlay b√™n ph·∫£i, kh√¥ng chi·∫øm ch·ªó layout */
#chatInfoPanel{
  position: absolute;       /* overlay thay v√¨ chi·∫øm c·ªôt */
  right: 0; top: 0; bottom: 0;
  width: 320px;             /* = w-80 */
  display: none;            /* .open => flex */
  background: #fff;
  border-left: 1px solid #e5e7eb;
  z-index: 30;
}
#chatInfoPanel.open { display: flex; flex-direction: column; }

/* ƒê·∫£m b·∫£o v√πng chat c√≥ th·ªÉ cu·ªôn, kh√¥ng b·ªã ‚Äúƒë·∫©y‚Äù m·∫•t input */
#mainChatArea{ min-width: 0; min-height: 0; }
#messagesContainer{ min-height: 0; }

    </style>
<link rel="stylesheet" href="/assets/css/loading.css">
</head>
<body class="bg-white h-screen overflow-hidden">
<div id="chatRoot" class="flex h-full relative">        <!-- Sidebar -->
        <div class="w-80 bg-white border-r border-gray-200 flex flex-col">
            <!-- Header -->
            <div class="p-4 border-b border-gray-200">
                <div class="flex items-center justify-between mb-4">
                    <h1 class="text-2xl font-bold text-gray-900">ƒêo·∫°n chat</h1>
                    <div class="flex space-x-1">
                        <button class="p-2 rounded-full hover:bg-gray-100" onclick="showSettings()">
                            <i class="fas fa-cog text-gray-600"></i>
                        </button>
                        <button class="p-2 rounded-full hover:bg-gray-100" onclick="showNewChatModal()">
                            <i class="fas fa-edit text-gray-600"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div class="flex space-x-2 mb-4">
                    <button onclick="showNewChatModal()" class="flex-1 bg-blue-100 text-blue-700 px-3 py-2 rounded-lg text-sm font-medium hover:bg-blue-200 transition-colors">
                        <i class="fas fa-plus mr-2"></i>T·∫°o cu·ªôc tr√≤ chuy·ªán
                    </button>
                    <button onclick="showRoomModal()" class="flex-1 bg-purple-100 text-purple-700 px-3 py-2 rounded-lg text-sm font-medium hover:bg-purple-200 transition-colors">
                        <i class="fas fa-video mr-2"></i>Cu·ªôc h·ªçp
                    </button>
                </div>
                
                <div class="relative">
                    <input id="searchInput" type="text" placeholder="T√¨m ki·∫øm trong Messenger" 
                           class="w-full pl-10 pr-4 py-2 bg-gray-100 rounded-full text-sm focus:outline-none focus:bg-white focus:ring-2 focus:ring-blue-500"
                           oninput="searchChats(this.value)">
                    <i class="fas fa-search absolute left-3 top-2.5 text-gray-400"></i>
                </div>
            </div>

            <!-- Chat List -->
            <div id="chatList" class="flex-1 overflow-y-auto" style="scrollbar-width: thin; scrollbar-color: #cbd5e1 #f1f5f9;">
                <style>
                    #chatList::-webkit-scrollbar {
                        width: 6px;
                    }
                    #chatList::-webkit-scrollbar-track {
                        background: #f1f5f9;
                        border-radius: 3px;
                    }
                    #chatList::-webkit-scrollbar-thumb {
                        background: #cbd5e1;
                        border-radius: 3px;
                    }
                    #chatList::-webkit-scrollbar-thumb:hover {
                        background: #94a3b8;
                    }
                </style>
                <div class="chat-item p-3 hover:bg-gray-50 cursor-pointer border-l-4 border-blue-500 bg-blue-50" onclick="selectChat('mai')" data-name="Mai Nguy·ªÖn" data-message="B·∫°n: Oke, h·∫πn g·∫∑p l·∫°i nh√©! üëã">
                    <div class="flex items-center space-x-3">
                        <div class="relative">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%23FF6B9D'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='16' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                                 alt="Mai" class="w-12 h-12 rounded-full">
                            <div class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white"></div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-center">
                                <h3 class="font-semibold text-gray-900 truncate">Mai Nguy·ªÖn</h3>
                                <span class="text-xs text-gray-500">2 ph√∫t</span>
                            </div>
                            <p class="text-sm text-gray-600 truncate">B·∫°n: Oke, h·∫πn g·∫∑p l·∫°i nh√©! üëã</p>
                        </div>
                    </div>
                </div>

                <div class="chat-item p-3 hover:bg-gray-50 cursor-pointer" onclick="selectChat('duc')" data-name="ƒê·ª©c Tr·∫ßn" data-message="H√¥m nay c√≥ r·∫£nh kh√¥ng? ü§î">
                    <div class="flex items-center space-x-3">
                        <div class="relative">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%234A90E2'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='16' font-weight='bold'%3ED%3C/text%3E%3C/svg%3E" 
                                 alt="ƒê·ª©c" class="w-12 h-12 rounded-full">
                            <div class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white"></div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-center">
                                <h3 class="font-semibold text-gray-900 truncate">ƒê·ª©c Tr·∫ßn</h3>
                                <span class="text-xs text-gray-500">15 ph√∫t</span>
                            </div>
                            <p class="text-sm text-gray-600 truncate">H√¥m nay c√≥ r·∫£nh kh√¥ng? ü§î</p>
                        </div>
                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                    </div>
                </div>

                <div class="chat-item p-3 hover:bg-gray-50 cursor-pointer" onclick="selectChat('linh')" data-name="Linh V√µ" data-message="C·∫£m ∆°n b·∫°n nhi·ªÅu! ‚ù§Ô∏è">
                    <div class="flex items-center space-x-3">
                        <div class="relative">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%23F39C12'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='16' font-weight='bold'%3EL%3C/text%3E%3C/svg%3E" 
                                 alt="Linh" class="w-12 h-12 rounded-full">
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-center">
                                <h3 class="font-semibold text-gray-900 truncate">Linh V√µ</h3>
                                <span class="text-xs text-gray-500">1 gi·ªù</span>
                            </div>
                            <p class="text-sm text-gray-600 truncate">C·∫£m ∆°n b·∫°n nhi·ªÅu! ‚ù§Ô∏è</p>
                        </div>
                    </div>
                </div>

                <div class="chat-item p-3 hover:bg-gray-50 cursor-pointer" onclick="selectChat('group')" data-name="Nh√≥m B·∫°n Th√¢n" data-message="An: Ai ƒëi xem phim kh√¥ng? üé¨">
                    <div class="flex items-center space-x-3">
                        <div class="relative">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%239B59B6'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3ENh√≥m%3C/text%3E%3C/svg%3E" 
                                 alt="Nh√≥m" class="w-12 h-12 rounded-full">
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-center">
                                <h3 class="font-semibold text-gray-900 truncate">Nh√≥m B·∫°n Th√¢n</h3>
                                <span class="text-xs text-gray-500">3 gi·ªù</span>
                            </div>
                            <p class="text-sm text-gray-600 truncate">An: Ai ƒëi xem phim kh√¥ng? üé¨</p>
                        </div>
                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                    </div>
                </div>

                <div class="chat-item p-3 hover:bg-gray-50 cursor-pointer" onclick="selectChat('an')" data-name="An L√™" data-message="T√†i li·ªáu ƒë√£ g·ª≠i r·ªìi nh√©!">
                    <div class="flex items-center space-x-3">
                        <div class="relative">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%2327AE60'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='16' font-weight='bold'%3EA%3C/text%3E%3C/svg%3E" 
                                 alt="An" class="w-12 h-12 rounded-full">
                            <div class="absolute bottom-0 right-0 w-3 h-3 bg-gray-400 rounded-full border-2 border-white"></div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-center">
                                <h3 class="font-semibold text-gray-900 truncate">An L√™</h3>
                                <span class="text-xs text-gray-500">5 gi·ªù</span>
                            </div>
                            <p class="text-sm text-gray-600 truncate">T√†i li·ªáu ƒë√£ g·ª≠i r·ªìi nh√©!</p>
                        </div>
                    </div>
                </div>

                <div class="chat-item p-3 hover:bg-gray-50 cursor-pointer" onclick="selectChat('hoa')" data-name="Hoa Ph·∫°m" data-message="B·∫°n: C·∫£m ∆°n b·∫°n! üòä">
                    <div class="flex items-center space-x-3">
                        <div class="relative">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%23E74C3C'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='16' font-weight='bold'%3EH%3C/text%3E%3C/svg%3E" 
                                 alt="Hoa" class="w-12 h-12 rounded-full">
                            <div class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white"></div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-center">
                                <h3 class="font-semibold text-gray-900 truncate">Hoa Ph·∫°m</h3>
                                <span class="text-xs text-gray-500">1 ng√†y</span>
                            </div>
                            <p class="text-sm text-gray-600 truncate">B·∫°n: C·∫£m ∆°n b·∫°n! üòä</p>
                        </div>
                    </div>
                </div>

                <div class="chat-item p-3 hover:bg-gray-50 cursor-pointer" onclick="selectChat('work')" data-name="Nh√≥m C√¥ng Vi·ªác" data-message="Minh: H·ªçp l√∫c 2h chi·ªÅu nh√©">
                    <div class="flex items-center space-x-3">
                        <div class="relative">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%2334495E'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3EWork%3C/text%3E%3C/svg%3E" 
                                 alt="Work" class="w-12 h-12 rounded-full">
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-center">
                                <h3 class="font-semibold text-gray-900 truncate">Nh√≥m C√¥ng Vi·ªác</h3>
                                <span class="text-xs text-gray-500">2 ng√†y</span>
                            </div>
                            <p class="text-sm text-gray-600 truncate">Minh: H·ªçp l√∫c 2h chi·ªÅu nh√©</p>
                        </div>
                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                    </div>
                </div>

                <div class="chat-item p-3 hover:bg-gray-50 cursor-pointer" onclick="selectChat('nam')" data-name="Nam V≈©" data-message="Ch√∫c m·ª´ng sinh nh·∫≠t! üéâ">
                    <div class="flex items-center space-x-3">
                        <div class="relative">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%23FF9500'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='16' font-weight='bold'%3EN%3C/text%3E%3C/svg%3E" 
                                 alt="Nam" class="w-12 h-12 rounded-full">
                            <div class="absolute bottom-0 right-0 w-3 h-3 bg-gray-400 rounded-full border-2 border-white"></div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-center">
                                <h3 class="font-semibold text-gray-900 truncate">Nam V≈©</h3>
                                <span class="text-xs text-gray-500">1 tu·∫ßn</span>
                            </div>
                            <p class="text-sm text-gray-600 truncate">Ch√∫c m·ª´ng sinh nh·∫≠t! üéâ</p>
                        </div>
                    </div>
                </div>

                <div class="chat-item p-3 hover:bg-gray-50 cursor-pointer" onclick="selectChat('family')" data-name="Gia ƒê√¨nh" data-message="M·∫π: Nh·ªõ ƒÉn c∆°m ƒë·∫ßy ƒë·ªß nh√© con! ‚ù§Ô∏è">
                    <div class="flex items-center space-x-3">
                        <div class="relative">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%23E91E63'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3EGƒê%3C/text%3E%3C/svg%3E" 
                                 alt="Gia ƒê√¨nh" class="w-12 h-12 rounded-full">
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-center">
                                <h3 class="font-semibold text-gray-900 truncate">Gia ƒê√¨nh</h3>
                                <span class="text-xs text-gray-500">2 ng√†y</span>
                            </div>
                            <p class="text-sm text-gray-600 truncate">M·∫π: Nh·ªõ ƒÉn c∆°m ƒë·∫ßy ƒë·ªß nh√© con! ‚ù§Ô∏è</p>
                        </div>
                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                    </div>
                </div>

                <div class="chat-item p-3 hover:bg-gray-50 cursor-pointer" onclick="selectChat('study')" data-name="Nh√≥m H·ªçc T·∫≠p" data-message="Tu·∫•n: B√†i t·∫≠p v·ªÅ nh√† kh√≥ qu√°! üìö">
                    <div class="flex items-center space-x-3">
                        <div class="relative">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%23673AB7'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3EHT%3C/text%3E%3C/svg%3E" 
                                 alt="H·ªçc T·∫≠p" class="w-12 h-12 rounded-full">
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-center">
                                <h3 class="font-semibold text-gray-900 truncate">Nh√≥m H·ªçc T·∫≠p</h3>
                                <span class="text-xs text-gray-500">3 ng√†y</span>
                            </div>
                            <p class="text-sm text-gray-600 truncate">Tu·∫•n: B√†i t·∫≠p v·ªÅ nh√† kh√≥ qu√°! üìö</p>
                        </div>
                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                    </div>
                </div>

                <div class="chat-item p-3 hover:bg-gray-50 cursor-pointer" onclick="selectChat('gaming')" data-name="Gaming Squad" data-message="Long: T·ªëi nay ch∆°i game kh√¥ng? üéÆ">
                    <div class="flex items-center space-x-3">
                        <div class="relative">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%23FF5722'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3EGS%3C/text%3E%3C/svg%3E" 
                                 alt="Gaming" class="w-12 h-12 rounded-full">
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-center">
                                <h3 class="font-semibold text-gray-900 truncate">Gaming Squad</h3>
                                <span class="text-xs text-gray-500">4 ng√†y</span>
                            </div>
                            <p class="text-sm text-gray-600 truncate">Long: T·ªëi nay ch∆°i game kh√¥ng? üéÆ</p>
                        </div>
                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                    </div>
                </div>

                <div class="chat-item p-3 hover:bg-gray-50 cursor-pointer" onclick="selectChat('travel')" data-name="Du L·ªãch C√πng Nhau" data-message="H∆∞∆°ng: ƒê√† L·∫°t cu·ªëi tu·∫ßn nh√©! üå∏">
                    <div class="flex items-center space-x-3">
                        <div class="relative">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%2300BCD4'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3EDL%3C/text%3E%3C/svg%3E" 
                                 alt="Du L·ªãch" class="w-12 h-12 rounded-full">
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-center">
                                <h3 class="font-semibold text-gray-900 truncate">Du L·ªãch C√πng Nhau</h3>
                                <span class="text-xs text-gray-500">5 ng√†y</span>
                            </div>
                            <p class="text-sm text-gray-600 truncate">H∆∞∆°ng: ƒê√† L·∫°t cu·ªëi tu·∫ßn nh√©! üå∏</p>
                        </div>
                    </div>
                </div>

                <div class="chat-item p-3 hover:bg-gray-50 cursor-pointer" onclick="selectChat('food')" data-name="H·ªôi ƒÇn U·ªëng" data-message="Phong: Qu√°n m·ªõi ngon l·∫Øm! üçú">
                    <div class="flex items-center space-x-3">
                        <div class="relative">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%23FF9800'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3EAU%3C/text%3E%3C/svg%3E" 
                                 alt="ƒÇn U·ªëng" class="w-12 h-12 rounded-full">
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-center">
                                <h3 class="font-semibold text-gray-900 truncate">H·ªôi ƒÇn U·ªëng</h3>
                                <span class="text-xs text-gray-500">1 tu·∫ßn</span>
                            </div>
                            <p class="text-sm text-gray-600 truncate">Phong: Qu√°n m·ªõi ngon l·∫Øm! üçú</p>
                        </div>
                    </div>
                </div>

                <div class="chat-item p-3 hover:bg-gray-50 cursor-pointer" onclick="selectChat('sport')" data-name="CLB Th·ªÉ Thao" data-message="Khang: S√°ng mai ƒë√° b√≥ng nh√©! ‚öΩ">
                    <div class="flex items-center space-x-3">
                        <div class="relative">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%234CAF50'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3ETT%3C/text%3E%3C/svg%3E" 
                                 alt="Th·ªÉ Thao" class="w-12 h-12 rounded-full">
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-center">
                                <h3 class="font-semibold text-gray-900 truncate">CLB Th·ªÉ Thao</h3>
                                <span class="text-xs text-gray-500">1 tu·∫ßn</span>
                            </div>
                            <p class="text-sm text-gray-600 truncate">Khang: S√°ng mai ƒë√° b√≥ng nh√©! ‚öΩ</p>
                        </div>
                    </div>
                </div>

                <div class="chat-item p-3 hover:bg-gray-50 cursor-pointer" onclick="selectChat('music')" data-name="Nh√≥m Nh·∫°c" data-message="Trang: B√†i h√°t m·ªõi hay l·∫Øm! üéµ">
                    <div class="flex items-center space-x-3">
                        <div class="relative">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%23795548'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3ENh·∫°c%3C/text%3E%3C/svg%3E" 
                                 alt="Nh·∫°c" class="w-12 h-12 rounded-full">
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-center">
                                <h3 class="font-semibold text-gray-900 truncate">Nh√≥m Nh·∫°c</h3>
                                <span class="text-xs text-gray-500">2 tu·∫ßn</span>
                            </div>
                            <p class="text-sm text-gray-600 truncate">Trang: B√†i h√°t m·ªõi hay l·∫Øm! üéµ</p>
                        </div>
                    </div>
                </div>

                <div class="chat-item p-3 hover:bg-gray-50 cursor-pointer" onclick="selectChat('photo')" data-name="Nhi·∫øp ·∫¢nh" data-message="Minh: ·∫¢nh sunset ƒë·∫πp qu√°! üì∏">
                    <div class="flex items-center space-x-3">
                        <div class="relative">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%23607D8B'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3ENA%3C/text%3E%3C/svg%3E" 
                                 alt="Nhi·∫øp ·∫¢nh" class="w-12 h-12 rounded-full">
                        </div>
                        <div class="flex-1 min-w-0">
                            <div class="flex justify-between items-center">
                                <h3 class="font-semibold text-gray-900 truncate">Nhi·∫øp ·∫¢nh</h3>
                                <span class="text-xs text-gray-500">2 tu·∫ßn</span>
                            </div>
                            <p class="text-sm text-gray-600 truncate">Minh: ·∫¢nh sunset ƒë·∫πp qu√°! üì∏</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Chat Area -->
        <div id="mainChatArea" class="flex-1 flex flex-col">
            <!-- Chat Header -->
            <div class="bg-white border-b border-gray-200 p-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <img id="chatAvatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%23FF6B9D'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='16' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                             alt="Mai" class="w-10 h-10 rounded-full">
                        <div>
                            <h2 id="chatName" class="font-semibold text-gray-900">Mai Nguy·ªÖn</h2>
                            <p id="chatStatus" class="text-sm text-green-600">ƒêang ho·∫°t ƒë·ªông</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-1">
                        <button class="p-2 rounded-full hover:bg-gray-100" onclick="showChatSearch()">
                            <i class="fas fa-search text-blue-600"></i>
                        </button>
                        <button class="p-2 rounded-full hover:bg-gray-100" onclick="startVoiceCall()">
                            <i class="fas fa-phone text-blue-600"></i>
                        </button>
                        <button class="p-2 rounded-full hover:bg-gray-100" onclick="startVideoCall()">
                            <i class="fas fa-video text-blue-600"></i>
                        </button>
                        <button class="p-2 rounded-full hover:bg-gray-100" onclick="toggleChatInfoPanel()">
                            <i class="fas fa-info-circle text-gray-600"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Chat Search Bar (Hidden by default) -->
                <div id="chatSearchBar" class="mt-3 hidden">
                    <div class="relative">
                        <input id="chatSearchInput" type="text" placeholder="T√¨m ki·∫øm trong ƒëo·∫°n chat n√†y..." 
                               class="w-full pl-10 pr-10 py-2 bg-gray-100 rounded-full text-sm focus:outline-none focus:bg-white focus:ring-2 focus:ring-blue-500"
                               oninput="searchInChat(this.value)">
                        <i class="fas fa-search absolute left-3 top-2.5 text-gray-400"></i>
                        <button onclick="closeChatSearch()" class="absolute right-3 top-2.5 text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Messages -->
            <div id="messagesContainer" class="flex-1 overflow-y-auto p-4 space-y-4 scrollbar-hide bg-gray-50">
                <div class="flex justify-start">
                    <div class="flex items-end space-x-2 max-w-xs">
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='28' viewBox='0 0 28 28'%3E%3Ccircle cx='14' cy='14' r='14' fill='%23FF6B9D'/%3E%3Ctext x='14' y='18' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                             alt="Mai" class="w-7 h-7 rounded-full">
                        <div class="bg-gray-200 rounded-2xl px-4 py-2 message-bubble">
                            <p class="text-gray-800">Ch√†o b·∫°n! H√¥m nay th·∫ø n√†o? üòä</p>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end">
                    <div class="bg-blue-500 text-white rounded-2xl px-4 py-2 max-w-xs message-bubble">
                        <p>Ch√†o Mai! M√¨nh ·ªïn, c·∫£m ∆°n b·∫°n. C√≤n b·∫°n th√¨ sao?</p>
                    </div>
                </div>

                <div class="flex justify-start">
                    <div class="flex items-end space-x-2 max-w-xs">
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='28' viewBox='0 0 28 28'%3E%3Ccircle cx='14' cy='14' r='14' fill='%23FF6B9D'/%3E%3Ctext x='14' y='18' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                             alt="Mai" class="w-7 h-7 rounded-full">
                        <div class="bg-gray-200 rounded-2xl px-4 py-2 message-bubble">
                            <p class="text-gray-800">M√¨nh c≈©ng t·ªët! Ng√†y mai c√≥ r·∫£nh kh√¥ng? M√¨nh mu·ªën m·ªùi b·∫°n ƒëi c√† ph√™ ‚òï</p>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end">
                    <div class="bg-blue-500 text-white rounded-2xl px-4 py-2 max-w-xs message-bubble">
                        <p>√ù t∆∞·ªüng hay ƒë·∫•y! M·∫•y gi·ªù nh·ªâ?</p>
                    </div>
                </div>

                <div class="flex justify-start">
                    <div class="flex items-end space-x-2 max-w-xs">
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='28' viewBox='0 0 28 28'%3E%3Ccircle cx='14' cy='14' r='14' fill='%23FF6B9D'/%3E%3Ctext x='14' y='18' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                             alt="Mai" class="w-7 h-7 rounded-full">
                        <div class="bg-gray-200 rounded-2xl px-4 py-2 message-bubble">
                            <p class="text-gray-800">2 gi·ªù chi·ªÅu ƒë∆∞·ª£c kh√¥ng? Qu√°n c√† ph√™ g·∫ßn tr∆∞·ªùng c≈© üìç</p>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end">
                    <div class="bg-blue-500 text-white rounded-2xl px-4 py-2 max-w-xs message-bubble">
                        <p>Oke, h·∫πn g·∫∑p l·∫°i nh√©! üëã</p>
                    </div>
                </div>

                <!-- Typing indicator -->
                <div id="typingIndicator" class="flex justify-start hidden">
                    <div class="flex items-end space-x-2">
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='28' viewBox='0 0 28 28'%3E%3Ccircle cx='14' cy='14' r='14' fill='%23FF6B9D'/%3E%3Ctext x='14' y='18' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                             alt="Mai" class="w-7 h-7 rounded-full">
                        <div class="bg-gray-200 rounded-2xl px-4 py-2 typing-indicator">
                            <div class="flex space-x-1">
                                <div class="w-2 h-2 bg-gray-500 rounded-full animate-bounce"></div>
                                <div class="w-2 h-2 bg-gray-500 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                                <div class="w-2 h-2 bg-gray-500 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Message Input -->
            <div class="bg-white border-t border-gray-200 p-4">
                <div class="flex items-center space-x-3">
                    <div class="relative">
                        <button class="p-2 rounded-full hover:bg-gray-100" onclick="showAttachmentMenu()">
                            <i class="fas fa-plus text-blue-600"></i>
                        </button>
                        <!-- Attachment Menu -->
                        <div id="attachmentMenu" class="absolute bottom-12 left-0 bg-white rounded-lg shadow-lg border p-2 hidden z-10">
                            <button onclick="selectFile()" class="flex items-center space-x-2 w-full p-2 hover:bg-gray-100 rounded text-left">
                                <i class="fas fa-file text-blue-600"></i>
                                <span class="text-sm">T√†i li·ªáu</span>
                            </button>
                            <button onclick="selectImage()" class="flex items-center space-x-2 w-full p-2 hover:bg-gray-100 rounded text-left">
                                <i class="fas fa-image text-green-600"></i>
                                <span class="text-sm">·∫¢nh/Video</span>
                            </button>
                            <button onclick="createPoll()" class="flex items-center space-x-2 w-full p-2 hover:bg-gray-100 rounded text-left">
                                <i class="fas fa-poll text-purple-600"></i>
                                <span class="text-sm">B√¨nh ch·ªçn</span>
                            </button>
                        </div>
                    </div>
                    <button class="p-2 rounded-full hover:bg-gray-100" onclick="selectImage()">
                        <i class="fas fa-image text-blue-600"></i>
                    </button>
                    <div class="flex-1 relative">
                        <input id="messageInput" type="text" placeholder="Aa" 
                               class="w-full px-4 py-2 bg-gray-100 rounded-full focus:outline-none focus:bg-white focus:ring-2 focus:ring-blue-500"
                               onkeypress="handleKeyPress(event)">
                    </div>
                    <button class="p-2 rounded-full hover:bg-gray-100">
                        <i class="fas fa-microphone text-blue-600"></i>
                    </button>
                    <button onclick="sendMessage()" class="p-2 rounded-full hover:bg-gray-100">
                        <i class="fas fa-paper-plane text-blue-600"></i>
                    </button>
                </div>
                
                <!-- File Upload Area (Hidden by default) -->
                <div id="fileUploadArea" class="mt-3 p-4 file-upload-area rounded-lg text-center hidden">
                    <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-2"></i>
                    <p class="text-gray-600">K√©o th·∫£ t√†i li·ªáu v√†o ƒë√¢y ho·∫∑c <button onclick="selectFile()" class="text-blue-600 underline">ch·ªçn t·ªáp</button></p>
                    <input type="file" id="fileInput" class="hidden" onchange="handleFileSelect(event)" multiple>
                </div>
            </div>
        </div>

        <!-- Chat Info Panel (Right Sidebar) -->
        <div id="chatInfoPanel" class="w-80 bg-white border-l border-gray-200 flex-col hidden">
            <!-- Panel Header -->
            <div class="p-4 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h2 class="text-lg font-semibold">Th√¥ng tin ƒëo·∫°n chat</h2>
                    <button onclick="toggleChatInfoPanel()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- Profile Section -->
            <div class="p-4 text-center border-b border-gray-200">
                <img id="panelChatAvatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Ccircle cx='40' cy='40' r='40' fill='%23FF6B9D'/%3E%3Ctext x='40' y='50' text-anchor='middle' fill='white' font-size='32' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                     alt="Mai" class="w-20 h-20 rounded-full mx-auto mb-3">
                <h3 id="panelChatName" class="text-xl font-semibold">Mai Nguy·ªÖn</h3>
                <p id="panelChatStatus" class="text-green-600 text-sm">ƒêang ho·∫°t ƒë·ªông</p>
                <div class="flex justify-center space-x-4 mt-4">
                    <button onclick="startVoiceCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-phone text-blue-600"></i>
                    </button>
                    <button onclick="startVideoCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-video text-blue-600"></i>
                    </button>
                    <button class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-user-plus text-blue-600"></i>
                    </button>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="flex-1 overflow-y-auto">
                <div class="p-4 space-y-2">
                    <button onclick="showChatSearch()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-search text-gray-600"></i>
                            <span>T√¨m ki·∫øm trong ƒëo·∫°n chat</span>
                        </div>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-bell text-gray-600"></i>
                            <span>T·∫Øt th√¥ng b√°o</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox">
                            <span class="slider round bg-gray-300 w-10 h-5 rounded-full relative inline-block">
                                <span class="dot absolute w-3 h-3 bg-white rounded-full top-1 left-1 transition-transform"></span>
                            </span>
                        </label>
                    </button>
                    
                    <button onclick="showThemeModal()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-palette text-gray-600"></i>
                            <span>ƒê·ªïi ch·ªß ƒë·ªÅ</span>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-thumbs-up text-gray-600"></i>
                            <span>ƒê·ªïi bi·ªÉu t∆∞·ª£ng c·∫£m x√∫c</span>
                        </div>
                        <span class="text-2xl">üëç</span>
                    </button>
                </div>

                <!-- Shared Files Section -->
                <div class="p-4 border-t border-gray-200">
                    <h4 class="font-semibold text-gray-900 mb-3">T√†i li·ªáu ƒë√£ chia s·∫ª</h4>
                    <div class="space-y-2 max-h-40 overflow-y-auto">
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                            <i class="fas fa-file-pdf text-red-600 text-xl"></i>
                            <div class="flex-1">
                                <p class="text-sm font-medium">B√°o c√°o th√°ng 11.pdf</p>
                                <p class="text-xs text-gray-500">2.3 MB ‚Ä¢ 3 ng√†y tr∆∞·ªõc</p>
                            </div>
                            <button class="p-1 hover:bg-gray-200 rounded">
                                <i class="fas fa-download text-gray-600"></i>
                            </button>
                        </div>
                        
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                            <i class="fas fa-image text-green-600 text-xl"></i>
                            <div class="flex-1">
                                <p class="text-sm font-medium">IMG_2024.jpg</p>
                                <p class="text-xs text-gray-500">1.8 MB ‚Ä¢ 1 tu·∫ßn tr∆∞·ªõc</p>
                            </div>
                            <button class="p-1 hover:bg-gray-200 rounded">
                                <i class="fas fa-download text-gray-600"></i>
                            </button>
                        </div>
                    </div>
                    <button class="w-full text-center text-blue-600 text-sm py-2 hover:bg-gray-50 rounded-lg mt-2">
                        Xem t·∫•t c·∫£ t√†i li·ªáu
                    </button>
                </div>

                <!-- Privacy & Support -->
                <div class="p-4 border-t border-gray-200 space-y-2">
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-shield-alt text-gray-600"></i>
                            <span>Quy·ªÅn ri√™ng t∆∞ & h·ªó tr·ª£</span>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg text-red-600">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-ban"></i>
                            <span>Ch·∫∑n</span>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Video Call Modal -->
    <div id="videoCallModal" class="fixed inset-0 bg-black bg-opacity-90 z-50 hidden">
        <div class="h-full flex flex-col">
            <!-- Call Header -->
            <div class="absolute top-4 left-4 z-10 text-white">
                <h3 class="text-lg font-semibold">Mai Nguy·ªÖn</h3>
                <p id="callDuration" class="text-sm text-gray-300">00:00</p>
            </div>
            
            <!-- Remote Video -->
            <div class="flex-1 relative bg-gray-900 flex items-center justify-center">
                <div class="text-center">
                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 120 120'%3E%3Ccircle cx='60' cy='60' r='60' fill='%23FF6B9D'/%3E%3Ctext x='60' y='75' text-anchor='middle' fill='white' font-size='48' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                         alt="Mai" class="w-32 h-32 rounded-full mx-auto mb-4 call-animation">
                    <h3 class="text-white text-2xl font-semibold mb-2">Mai Nguy·ªÖn</h3>
                    <p class="text-gray-300">ƒêang g·ªçi video...</p>
                </div>
                
                <!-- Local Video -->
                <div class="absolute top-4 right-4 w-40 h-32 bg-gray-800 rounded-lg border-2 border-white overflow-hidden">
                    <div class="w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center">
                        <i class="fas fa-user text-white text-2xl"></i>
                    </div>
                </div>
            </div>

            <!-- Call Controls -->
            <div class="bg-black bg-opacity-50 p-6">
                <div class="flex justify-center space-x-4">
                    <button id="muteBtn" onclick="toggleMute()" class="w-14 h-14 bg-gray-600 rounded-full flex items-center justify-center hover:bg-gray-500 transition-colors">
                        <i class="fas fa-microphone text-white text-xl"></i>
                    </button>
                    <button id="videoBtn" onclick="toggleVideo()" class="w-14 h-14 bg-gray-600 rounded-full flex items-center justify-center hover:bg-gray-500 transition-colors">
                        <i class="fas fa-video text-white text-xl"></i>
                    </button>
                    <button onclick="toggleScreenShare()" class="w-14 h-14 bg-gray-600 rounded-full flex items-center justify-center hover:bg-gray-500 transition-colors">
                        <i class="fas fa-desktop text-white text-xl"></i>
                    </button>
                    <button onclick="endCall()" class="w-14 h-14 bg-red-600 rounded-full flex items-center justify-center hover:bg-red-500 transition-colors">
                        <i class="fas fa-phone-slash text-white text-xl"></i>
                    </button>
                    <button onclick="toggleFullscreen()" class="w-14 h-14 bg-gray-600 rounded-full flex items-center justify-center hover:bg-gray-500 transition-colors">
                        <i class="fas fa-expand text-white text-xl"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Chat Info Panel (Right Sidebar) -->
        <div id="chatInfoPanel" class="w-80 bg-white border-l border-gray-200 flex-col hidden">
            <!-- Panel Header -->
            <div class="p-4 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h2 class="text-lg font-semibold">Th√¥ng tin ƒëo·∫°n chat</h2>
                    <button onclick="toggleChatInfoPanel()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- Profile Section -->
            <div class="p-4 text-center border-b border-gray-200">
                <img id="panelChatAvatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Ccircle cx='40' cy='40' r='40' fill='%23FF6B9D'/%3E%3Ctext x='40' y='50' text-anchor='middle' fill='white' font-size='32' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                     alt="Mai" class="w-20 h-20 rounded-full mx-auto mb-3">
                <h3 id="panelChatName" class="text-xl font-semibold">Mai Nguy·ªÖn</h3>
                <p id="panelChatStatus" class="text-green-600 text-sm">ƒêang ho·∫°t ƒë·ªông</p>
                <div class="flex justify-center space-x-4 mt-4">
                    <button onclick="startVoiceCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-phone text-blue-600"></i>
                    </button>
                    <button onclick="startVideoCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-video text-blue-600"></i>
                    </button>
                    <button class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-user-plus text-blue-600"></i>
                    </button>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="flex-1 overflow-y-auto">
                <div class="p-4 space-y-2">
                    <button onclick="showChatSearch()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-search text-gray-600"></i>
                            <span>T√¨m ki·∫øm trong ƒëo·∫°n chat</span>
                        </div>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-bell text-gray-600"></i>
                            <span>T·∫Øt th√¥ng b√°o</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox">
                            <span class="slider round bg-gray-300 w-10 h-5 rounded-full relative inline-block">
                                <span class="dot absolute w-3 h-3 bg-white rounded-full top-1 left-1 transition-transform"></span>
                            </span>
                        </label>
                    </button>
                    
                    <button onclick="showThemeModal()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-palette text-gray-600"></i>
                            <span>ƒê·ªïi ch·ªß ƒë·ªÅ</span>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-thumbs-up text-gray-600"></i>
                            <span>ƒê·ªïi bi·ªÉu t∆∞·ª£ng c·∫£m x√∫c</span>
                        </div>
                        <span class="text-2xl">üëç</span>
                    </button>
                </div>

                <!-- Shared Files Section -->
                <div class="p-4 border-t border-gray-200">
                    <h4 class="font-semibold text-gray-900 mb-3">T√†i li·ªáu ƒë√£ chia s·∫ª</h4>
                    <div class="space-y-2 max-h-40 overflow-y-auto">
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                            <i class="fas fa-file-pdf text-red-600 text-xl"></i>
                            <div class="flex-1">
                                <p class="text-sm font-medium">B√°o c√°o th√°ng 11.pdf</p>
                                <p class="text-xs text-gray-500">2.3 MB ‚Ä¢ 3 ng√†y tr∆∞·ªõc</p>
                            </div>
                            <button class="p-1 hover:bg-gray-200 rounded">
                                <i class="fas fa-download text-gray-600"></i>
                            </button>
                        </div>
                        
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                            <i class="fas fa-image text-green-600 text-xl"></i>
                            <div class="flex-1">
                                <p class="text-sm font-medium">IMG_2024.jpg</p>
                                <p class="text-xs text-gray-500">1.8 MB ‚Ä¢ 1 tu·∫ßn tr∆∞·ªõc</p>
                            </div>
                            <button class="p-1 hover:bg-gray-200 rounded">
                                <i class="fas fa-download text-gray-600"></i>
                            </button>
                        </div>
                    </div>
                    <button class="w-full text-center text-blue-600 text-sm py-2 hover:bg-gray-50 rounded-lg mt-2">
                        Xem t·∫•t c·∫£ t√†i li·ªáu
                    </button>
                </div>

                <!-- Privacy & Support -->
                <div class="p-4 border-t border-gray-200 space-y-2">
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-shield-alt text-gray-600"></i>
                            <span>Quy·ªÅn ri√™ng t∆∞ & h·ªó tr·ª£</span>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg text-red-600">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-ban"></i>
                            <span>Ch·∫∑n</span>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Voice Call Modal -->
    <div id="voiceCallModal" class="fixed inset-0 bg-gradient-to-br from-purple-900 to-blue-900 z-50 hidden">
        <div class="h-full flex flex-col items-center justify-center text-center relative">
            <!-- Call Duration -->
            <div class="absolute top-8 left-1/2 transform -translate-x-1/2">
                <p id="voiceCallDuration" class="text-white text-lg">00:00</p>
            </div>
            
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='150' height='150' viewBox='0 0 150 150'%3E%3Ccircle cx='75' cy='75' r='75' fill='%23FF6B9D'/%3E%3Ctext x='75' y='90' text-anchor='middle' fill='white' font-size='60' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                 alt="Mai" class="w-40 h-40 rounded-full mb-6 call-animation">
            <h2 class="text-white text-3xl font-semibold mb-2">Mai Nguy·ªÖn</h2>
            <p class="text-gray-300 text-lg mb-12">ƒêang g·ªçi...</p>
            
            <div class="flex space-x-6">
                <button id="voiceMuteBtn" onclick="toggleVoiceMute()" class="w-16 h-16 bg-gray-600 bg-opacity-50 rounded-full flex items-center justify-center hover:bg-gray-500 transition-colors">
                    <i class="fas fa-microphone text-white text-2xl"></i>
                </button>
                <button onclick="switchToVideo()" class="w-16 h-16 bg-blue-600 bg-opacity-50 rounded-full flex items-center justify-center hover:bg-blue-500 transition-colors">
                    <i class="fas fa-video text-white text-2xl"></i>
                </button>
                <button onclick="endCall()" class="w-16 h-16 bg-red-600 rounded-full flex items-center justify-center hover:bg-red-500 transition-colors">
                    <i class="fas fa-phone-slash text-white text-2xl"></i>
                </button>
                <!-- N√∫t xanh ch·ªâ hi·ªán khi c√≥ cu·ªôc g·ªçi ƒë·∫øn -->
                <button id="answerCallBtn" onclick="answerCall()" class="w-16 h-16 bg-green-600 rounded-full flex items-center justify-center hover:bg-green-500 transition-colors hidden">
                    <i class="fas fa-phone text-white text-2xl"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center h-full">
            <div class="bg-white rounded-lg w-[600px] max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-semibold">C√†i ƒë·∫∑t</h2>
                        <button onclick="closeSettings()" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <!-- Profile Section -->
                    <div class="flex items-center space-x-4 p-4 bg-gray-50 rounded-lg mb-6">
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60' viewBox='0 0 60 60'%3E%3Ccircle cx='30' cy='30' r='30' fill='%234A90E2'/%3E%3Ctext x='30' y='38' text-anchor='middle' fill='white' font-size='24' font-weight='bold'%3EU%3C/text%3E%3C/svg%3E" 
                             alt="User" class="w-16 h-16 rounded-full">
                        <div class="flex-1">
                            <h3 class="text-lg font-semibold">Ng∆∞·ªùi d√πng</h3>
                            <p class="text-gray-600">user@example.com</p>
                            <button class="text-blue-600 text-sm hover:underline">Ch·ªânh s·ª≠a h·ªì s∆°</button>
                        </div>
                    </div>
                    
                    <!-- Settings Sections -->
                    <div class="space-y-6">
                        <!-- Appearance -->
                        <div>
                            <h3 class="text-lg font-semibold mb-4">Giao di·ªán</h3>
                            <div class="space-y-3">
                                <div class="flex items-center justify-between py-3 px-4 bg-gray-50 rounded-lg">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-moon text-gray-600"></i>
                                        <div>
                                            <span class="font-medium">Ch·∫ø ƒë·ªô t·ªëi</span>
                                            <p class="text-sm text-gray-500">B·∫≠t ch·∫ø ƒë·ªô t·ªëi ƒë·ªÉ b·∫£o v·ªá m·∫Øt</p>
                                        </div>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" onchange="toggleDarkMode(this)">
                                        <span class="slider round bg-gray-300 w-12 h-6 rounded-full relative inline-block cursor-pointer">
                                            <span class="dot absolute w-4 h-4 bg-white rounded-full top-1 left-1 transition-transform duration-300"></span>
                                        </span>
                                    </label>
                                </div>
                                
                                <div class="flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg cursor-pointer">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-text-height text-gray-600"></i>
                                        <div>
                                            <span class="font-medium">K√≠ch th∆∞·ªõc ch·ªØ</span>
                                            <p class="text-sm text-gray-500">ƒêi·ªÅu ch·ªânh k√≠ch th∆∞·ªõc vƒÉn b·∫£n</p>
                                        </div>
                                    </div>
                                    <select class="bg-white border border-gray-300 rounded px-3 py-1 text-sm">
                                        <option>Nh·ªè</option>
                                        <option selected>Trung b√¨nh</option>
                                        <option>L·ªõn</option>
                                    </select>
                                </div>
                                
                                <div class="flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg cursor-pointer">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-palette text-gray-600"></i>
                                        <div>
                                            <span class="font-medium">Ch·ªß ƒë·ªÅ m√†u s·∫Øc</span>
                                            <p class="text-sm text-gray-500">T√πy ch·ªânh m√†u s·∫Øc giao di·ªán</p>
                                        </div>
                                    </div>
                                    <div class="flex space-x-2">
                                        <div class="w-6 h-6 bg-blue-500 rounded-full cursor-pointer border-2 border-blue-600"></div>
                                        <div class="w-6 h-6 bg-green-500 rounded-full cursor-pointer"></div>
                                        <div class="w-6 h-6 bg-purple-500 rounded-full cursor-pointer"></div>
                                        <div class="w-6 h-6 bg-pink-500 rounded-full cursor-pointer"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Notifications -->
                        <div>
                            <h3 class="text-lg font-semibold mb-4">Th√¥ng b√°o</h3>
                            <div class="space-y-3">
                                <div class="flex items-center justify-between py-3 px-4 bg-gray-50 rounded-lg">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-bell text-gray-600"></i>
                                        <div>
                                            <span class="font-medium">Th√¥ng b√°o tin nh·∫Øn</span>
                                            <p class="text-sm text-gray-500">Nh·∫≠n th√¥ng b√°o khi c√≥ tin nh·∫Øn m·ªõi</p>
                                        </div>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked>
                                        <span class="slider round bg-blue-500 w-12 h-6 rounded-full relative inline-block cursor-pointer">
                                            <span class="dot absolute w-4 h-4 bg-white rounded-full top-1 right-1 transition-transform duration-300"></span>
                                        </span>
                                    </label>
                                </div>
                                
                                <div class="flex items-center justify-between py-3 px-4 bg-gray-50 rounded-lg">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-volume-up text-gray-600"></i>
                                        <div>
                                            <span class="font-medium">√Çm thanh th√¥ng b√°o</span>
                                            <p class="text-sm text-gray-500">Ph√°t √¢m thanh khi c√≥ th√¥ng b√°o</p>
                                        </div>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked>
                                        <span class="slider round bg-blue-500 w-12 h-6 rounded-full relative inline-block cursor-pointer">
                                            <span class="dot absolute w-4 h-4 bg-white rounded-full top-1 right-1 transition-transform duration-300"></span>
                                        </span>
                                    </label>
                                </div>
                                
                                <div class="flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg cursor-pointer">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-clock text-gray-600"></i>
                                        <div>
                                            <span class="font-medium">Kh√¥ng l√†m phi·ªÅn</span>
                                            <p class="text-sm text-gray-500">T·∫°m t·∫Øt th√¥ng b√°o trong kho·∫£ng th·ªùi gian</p>
                                        </div>
                                    </div>
                                    <select class="bg-white border border-gray-300 rounded px-3 py-1 text-sm">
                                        <option>T·∫Øt</option>
                                        <option>15 ph√∫t</option>
                                        <option>1 gi·ªù</option>
                                        <option>8 gi·ªù</option>
                                        <option>24 gi·ªù</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Privacy & Security -->
                        <div>
                            <h3 class="text-lg font-semibold mb-4">Quy·ªÅn ri√™ng t∆∞ & B·∫£o m·∫≠t</h3>
                            <div class="space-y-3">
                                <div class="flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg cursor-pointer">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-eye text-gray-600"></i>
                                        <div>
                                            <span class="font-medium">Tr·∫°ng th√°i ho·∫°t ƒë·ªông</span>
                                            <p class="text-sm text-gray-500">Cho ph√©p ng∆∞·ªùi kh√°c th·∫•y khi b·∫°n online</p>
                                        </div>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked>
                                        <span class="slider round bg-blue-500 w-12 h-6 rounded-full relative inline-block cursor-pointer">
                                            <span class="dot absolute w-4 h-4 bg-white rounded-full top-1 right-1 transition-transform duration-300"></span>
                                        </span>
                                    </label>
                                </div>
                                
                                <div class="flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg cursor-pointer">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-check-double text-gray-600"></i>
                                        <div>
                                            <span class="font-medium">X√°c nh·∫≠n ƒë√£ ƒë·ªçc</span>
                                            <p class="text-sm text-gray-500">Hi·ªÉn th·ªã khi b·∫°n ƒë√£ ƒë·ªçc tin nh·∫Øn</p>
                                        </div>
                                    </div>
                                    <label class="switch">
                                        <input type="checkbox" checked>
                                        <span class="slider round bg-blue-500 w-12 h-6 rounded-full relative inline-block cursor-pointer">
                                            <span class="dot absolute w-4 h-4 bg-white rounded-full top-1 right-1 transition-transform duration-300"></span>
                                        </span>
                                    </label>
                                </div>
                                
                                <div class="flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg cursor-pointer">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-lock text-gray-600"></i>
                                        <span class="font-medium">ƒê·ªïi m·∫≠t kh·∫©u</span>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                                
                                <div class="flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg cursor-pointer">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-shield-alt text-gray-600"></i>
                                        <span class="font-medium">X√°c th·ª±c 2 b∆∞·ªõc</span>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Data & Storage -->
                        <div>
                            <h3 class="text-lg font-semibold mb-4">D·ªØ li·ªáu & L∆∞u tr·ªØ</h3>
                            <div class="space-y-3">
                                <div class="flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg cursor-pointer">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-download text-gray-600"></i>
                                        <div>
                                            <span class="font-medium">T·ª± ƒë·ªông t·∫£i xu·ªëng</span>
                                            <p class="text-sm text-gray-500">T·ª± ƒë·ªông t·∫£i ·∫£nh v√† video</p>
                                        </div>
                                    </div>
                                    <select class="bg-white border border-gray-300 rounded px-3 py-1 text-sm">
                                        <option>Kh√¥ng bao gi·ªù</option>
                                        <option selected>Ch·ªâ khi d√πng WiFi</option>
                                        <option>Lu√¥n lu√¥n</option>
                                    </select>
                                </div>
                                
                                <div class="flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg cursor-pointer">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-trash text-gray-600"></i>
                                        <span class="font-medium">X√≥a d·ªØ li·ªáu cache</span>
                                    </div>
                                    <span class="text-sm text-gray-500">2.3 GB</span>
                                </div>
                                
                                <div class="flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg cursor-pointer">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-database text-gray-600"></i>
                                        <span class="font-medium">Sao l∆∞u d·ªØ li·ªáu</span>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Account Actions -->
                        <div class="pt-4 border-t">
                            <div class="space-y-3">
                                <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg text-left">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-question-circle text-gray-600"></i>
                                        <span class="font-medium">Tr·ª£ gi√∫p & H·ªó tr·ª£</span>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </button>
                                
                                <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg text-left">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-info-circle text-gray-600"></i>
                                        <span class="font-medium">V·ªÅ Messenger</span>
                                    </div>
                                    <span class="text-sm text-gray-500">v2024.1.0</span>
                                </button>
                                
                                <button onclick="logout()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-red-50 rounded-lg text-left text-red-600">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-sign-out-alt"></i>
                                        <span class="font-medium">ƒêƒÉng xu·∫•t</span>
                                    </div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Info Panel (Right Sidebar) -->
        <div id="chatInfoPanel" class="w-80 bg-white border-l border-gray-200 flex-col hidden">
            <!-- Panel Header -->
            <div class="p-4 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h2 class="text-lg font-semibold">Th√¥ng tin ƒëo·∫°n chat</h2>
                    <button onclick="toggleChatInfoPanel()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- Profile Section -->
            <div class="p-4 text-center border-b border-gray-200">
                <img id="panelChatAvatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Ccircle cx='40' cy='40' r='40' fill='%23FF6B9D'/%3E%3Ctext x='40' y='50' text-anchor='middle' fill='white' font-size='32' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                     alt="Mai" class="w-20 h-20 rounded-full mx-auto mb-3">
                <h3 id="panelChatName" class="text-xl font-semibold">Mai Nguy·ªÖn</h3>
                <p id="panelChatStatus" class="text-green-600 text-sm">ƒêang ho·∫°t ƒë·ªông</p>
                <div class="flex justify-center space-x-4 mt-4">
                    <button onclick="startVoiceCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-phone text-blue-600"></i>
                    </button>
                    <button onclick="startVideoCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-video text-blue-600"></i>
                    </button>
                    <button class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-user-plus text-blue-600"></i>
                    </button>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="flex-1 overflow-y-auto">
                <div class="p-4 space-y-2">
                    <button onclick="showChatSearch()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-search text-gray-600"></i>
                            <span>T√¨m ki·∫øm trong ƒëo·∫°n chat</span>
                        </div>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-bell text-gray-600"></i>
                            <span>T·∫Øt th√¥ng b√°o</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox">
                            <span class="slider round bg-gray-300 w-10 h-5 rounded-full relative inline-block">
                                <span class="dot absolute w-3 h-3 bg-white rounded-full top-1 left-1 transition-transform"></span>
                            </span>
                        </label>
                    </button>
                    
                    <button onclick="showThemeModal()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-palette text-gray-600"></i>
                            <span>ƒê·ªïi ch·ªß ƒë·ªÅ</span>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-thumbs-up text-gray-600"></i>
                            <span>ƒê·ªïi bi·ªÉu t∆∞·ª£ng c·∫£m x√∫c</span>
                        </div>
                        <span class="text-2xl">üëç</span>
                    </button>
                </div>

                <!-- Shared Files Section -->
                <div class="p-4 border-t border-gray-200">
                    <h4 class="font-semibold text-gray-900 mb-3">T√†i li·ªáu ƒë√£ chia s·∫ª</h4>
                    <div class="space-y-2 max-h-40 overflow-y-auto">
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                            <i class="fas fa-file-pdf text-red-600 text-xl"></i>
                            <div class="flex-1">
                                <p class="text-sm font-medium">B√°o c√°o th√°ng 11.pdf</p>
                                <p class="text-xs text-gray-500">2.3 MB ‚Ä¢ 3 ng√†y tr∆∞·ªõc</p>
                            </div>
                            <button class="p-1 hover:bg-gray-200 rounded">
                                <i class="fas fa-download text-gray-600"></i>
                            </button>
                        </div>
                        
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                            <i class="fas fa-image text-green-600 text-xl"></i>
                            <div class="flex-1">
                                <p class="text-sm font-medium">IMG_2024.jpg</p>
                                <p class="text-xs text-gray-500">1.8 MB ‚Ä¢ 1 tu·∫ßn tr∆∞·ªõc</p>
                            </div>
                            <button class="p-1 hover:bg-gray-200 rounded">
                                <i class="fas fa-download text-gray-600"></i>
                            </button>
                        </div>
                    </div>
                    <button class="w-full text-center text-blue-600 text-sm py-2 hover:bg-gray-50 rounded-lg mt-2">
                        Xem t·∫•t c·∫£ t√†i li·ªáu
                    </button>
                </div>

                <!-- Privacy & Support -->
                <div class="p-4 border-t border-gray-200 space-y-2">
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-shield-alt text-gray-600"></i>
                            <span>Quy·ªÅn ri√™ng t∆∞ & h·ªó tr·ª£</span>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg text-red-600">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-ban"></i>
                            <span>Ch·∫∑n</span>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Info Modal -->
    <div id="chatInfoModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center h-full">
            <div class="bg-white rounded-lg w-[500px] max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-semibold">Th√¥ng tin ƒëo·∫°n chat</h2>
                        <button onclick="closeChatInfo()" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <!-- Profile Section -->
                    <div class="text-center mb-6 pb-6 border-b">
                        <img id="chatInfoAvatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Ccircle cx='40' cy='40' r='40' fill='%23FF6B9D'/%3E%3Ctext x='40' y='50' text-anchor='middle' fill='white' font-size='32' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                             alt="Mai" class="w-20 h-20 rounded-full mx-auto mb-3">
                        <h3 id="chatInfoName" class="text-xl font-semibold">Mai Nguy·ªÖn</h3>
                        <p id="chatInfoStatus" class="text-green-600 text-sm">ƒêang ho·∫°t ƒë·ªông</p>
                        <div class="flex justify-center space-x-4 mt-4">
                            <button onclick="startVoiceCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                                <i class="fas fa-phone text-blue-600"></i>
                            </button>
                            <button onclick="startVideoCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                                <i class="fas fa-video text-blue-600"></i>
                            </button>
                            <button class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                                <i class="fas fa-user-plus text-blue-600"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Quick Actions -->
                    <div class="space-y-2 mb-6">
                        <button onclick="showChatSearch()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                            <div class="flex items-center space-x-3">
                                <i class="fas fa-search text-gray-600"></i>
                                <span>T√¨m ki·∫øm trong ƒëo·∫°n chat</span>
                            </div>
                        </button>
                        
                        <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                            <div class="flex items-center space-x-3">
                                <i class="fas fa-bell text-gray-600"></i>
                                <span>T·∫Øt th√¥ng b√°o</span>
                            </div>
                            <label class="switch">
                                <input type="checkbox">
                                <span class="slider round bg-gray-300 w-10 h-5 rounded-full relative inline-block">
                                    <span class="dot absolute w-3 h-3 bg-white rounded-full top-1 left-1 transition-transform"></span>
                                </span>
                            </label>
                        </button>
                        
                        <button onclick="showThemeModal()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                            <div class="flex items-center space-x-3">
                                <i class="fas fa-palette text-gray-600"></i>
                                <span>ƒê·ªïi ch·ªß ƒë·ªÅ</span>
                            </div>
                            <i class="fas fa-chevron-right text-gray-400"></i>
                        </button>
                        
                        <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                            <div class="flex items-center space-x-3">
                                <i class="fas fa-thumbs-up text-gray-600"></i>
                                <span>ƒê·ªïi bi·ªÉu t∆∞·ª£ng c·∫£m x√∫c</span>
                            </div>
                            <span class="text-2xl">üëç</span>
                        </button>
                    </div>
                    
                    <!-- Shared Files Section -->
                    <div class="mb-6">
                        <h4 class="font-semibold text-gray-900 mb-3">T√†i li·ªáu ƒë√£ chia s·∫ª</h4>
                        <div class="space-y-2 max-h-40 overflow-y-auto">
                            <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                                <i class="fas fa-file-pdf text-red-600 text-xl"></i>
                                <div class="flex-1">
                                    <p class="text-sm font-medium">B√°o c√°o th√°ng 11.pdf</p>
                                    <p class="text-xs text-gray-500">2.3 MB ‚Ä¢ 3 ng√†y tr∆∞·ªõc</p>
                                </div>
                                <button class="p-1 hover:bg-gray-200 rounded">
                                    <i class="fas fa-download text-gray-600"></i>
                                </button>
                            </div>
                            
                            <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                                <i class="fas fa-image text-green-600 text-xl"></i>
                                <div class="flex-1">
                                    <p class="text-sm font-medium">IMG_2024.jpg</p>
                                    <p class="text-xs text-gray-500">1.8 MB ‚Ä¢ 1 tu·∫ßn tr∆∞·ªõc</p>
                                </div>
                                <button class="p-1 hover:bg-gray-200 rounded">
                                    <i class="fas fa-download text-gray-600"></i>
                                </button>
                            </div>
                            
                            <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                                <i class="fas fa-file-word text-blue-600 text-xl"></i>
                                <div class="flex-1">
                                    <p class="text-sm font-medium">K·∫ø ho·∫°ch d·ª± √°n.docx</p>
                                    <p class="text-xs text-gray-500">856 KB ‚Ä¢ 2 tu·∫ßn tr∆∞·ªõc</p>
                                </div>
                                <button class="p-1 hover:bg-gray-200 rounded">
                                    <i class="fas fa-download text-gray-600"></i>
                                </button>
                            </div>
                        </div>
                        <button class="w-full text-center text-blue-600 text-sm py-2 hover:bg-gray-50 rounded-lg mt-2">
                            Xem t·∫•t c·∫£ t√†i li·ªáu
                        </button>
                    </div>
                    
                    <!-- Privacy & Support -->
                    <div class="space-y-2 pt-4 border-t">
                        <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                            <div class="flex items-center space-x-3">
                                <i class="fas fa-shield-alt text-gray-600"></i>
                                <span>Quy·ªÅn ri√™ng t∆∞ & h·ªó tr·ª£</span>
                            </div>
                            <i class="fas fa-chevron-right text-gray-400"></i>
                        </button>
                        
                        <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg text-red-600">
                            <div class="flex items-center space-x-3">
                                <i class="fas fa-ban"></i>
                                <span>Ch·∫∑n</span>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Info Panel (Right Sidebar) -->
        <div id="chatInfoPanel" class="w-80 bg-white border-l border-gray-200 flex-col hidden">
            <!-- Panel Header -->
            <div class="p-4 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h2 class="text-lg font-semibold">Th√¥ng tin ƒëo·∫°n chat</h2>
                    <button onclick="toggleChatInfoPanel()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- Profile Section -->
            <div class="p-4 text-center border-b border-gray-200">
                <img id="panelChatAvatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Ccircle cx='40' cy='40' r='40' fill='%23FF6B9D'/%3E%3Ctext x='40' y='50' text-anchor='middle' fill='white' font-size='32' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                     alt="Mai" class="w-20 h-20 rounded-full mx-auto mb-3">
                <h3 id="panelChatName" class="text-xl font-semibold">Mai Nguy·ªÖn</h3>
                <p id="panelChatStatus" class="text-green-600 text-sm">ƒêang ho·∫°t ƒë·ªông</p>
                <div class="flex justify-center space-x-4 mt-4">
                    <button onclick="startVoiceCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-phone text-blue-600"></i>
                    </button>
                    <button onclick="startVideoCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-video text-blue-600"></i>
                    </button>
                    <button class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-user-plus text-blue-600"></i>
                    </button>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="flex-1 overflow-y-auto">
                <div class="p-4 space-y-2">
                    <button onclick="showChatSearch()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-search text-gray-600"></i>
                            <span>T√¨m ki·∫øm trong ƒëo·∫°n chat</span>
                        </div>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-bell text-gray-600"></i>
                            <span>T·∫Øt th√¥ng b√°o</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox">
                            <span class="slider round bg-gray-300 w-10 h-5 rounded-full relative inline-block">
                                <span class="dot absolute w-3 h-3 bg-white rounded-full top-1 left-1 transition-transform"></span>
                            </span>
                        </label>
                    </button>
                    
                    <button onclick="showThemeModal()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-palette text-gray-600"></i>
                            <span>ƒê·ªïi ch·ªß ƒë·ªÅ</span>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-thumbs-up text-gray-600"></i>
                            <span>ƒê·ªïi bi·ªÉu t∆∞·ª£ng c·∫£m x√∫c</span>
                        </div>
                        <span class="text-2xl">üëç</span>
                    </button>
                </div>

                <!-- Shared Files Section -->
                <div class="p-4 border-t border-gray-200">
                    <h4 class="font-semibold text-gray-900 mb-3">T√†i li·ªáu ƒë√£ chia s·∫ª</h4>
                    <div class="space-y-2 max-h-40 overflow-y-auto">
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                            <i class="fas fa-file-pdf text-red-600 text-xl"></i>
                            <div class="flex-1">
                                <p class="text-sm font-medium">B√°o c√°o th√°ng 11.pdf</p>
                                <p class="text-xs text-gray-500">2.3 MB ‚Ä¢ 3 ng√†y tr∆∞·ªõc</p>
                            </div>
                            <button class="p-1 hover:bg-gray-200 rounded">
                                <i class="fas fa-download text-gray-600"></i>
                            </button>
                        </div>
                        
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                            <i class="fas fa-image text-green-600 text-xl"></i>
                            <div class="flex-1">
                                <p class="text-sm font-medium">IMG_2024.jpg</p>
                                <p class="text-xs text-gray-500">1.8 MB ‚Ä¢ 1 tu·∫ßn tr∆∞·ªõc</p>
                            </div>
                            <button class="p-1 hover:bg-gray-200 rounded">
                                <i class="fas fa-download text-gray-600"></i>
                            </button>
                        </div>
                    </div>
                    <button class="w-full text-center text-blue-600 text-sm py-2 hover:bg-gray-50 rounded-lg mt-2">
                        Xem t·∫•t c·∫£ t√†i li·ªáu
                    </button>
                </div>

                <!-- Privacy & Support -->
                <div class="p-4 border-t border-gray-200 space-y-2">
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-shield-alt text-gray-600"></i>
                            <span>Quy·ªÅn ri√™ng t∆∞ & h·ªó tr·ª£</span>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg text-red-600">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-ban"></i>
                            <span>Ch·∫∑n</span>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- New Chat Modal -->
    <div id="newChatModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center h-full">
            <div class="bg-white rounded-lg w-96">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-semibold">Cu·ªôc tr√≤ chuy·ªán m·ªõi</h2>
                        <button onclick="closeNewChatModal()" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="mb-4">
                        <input type="text" placeholder="Nh·∫≠p t√™n ho·∫∑c s·ªë ƒëi·ªán tho·∫°i..." 
                               class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <div class="space-y-2 max-h-60 overflow-y-auto">
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg cursor-pointer">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%2316A085'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='16' font-weight='bold'%3ET%3C/text%3E%3C/svg%3E" 
                                 alt="Tu·∫•n" class="w-10 h-10 rounded-full">
                            <div>
                                <h3 class="font-medium">Tu·∫•n Nguy·ªÖn</h3>
                                <p class="text-sm text-gray-500">ƒêang ho·∫°t ƒë·ªông</p>
                            </div>
                        </div>
                        
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg cursor-pointer">
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='%23E67E22'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='16' font-weight='bold'%3EQ%3C/text%3E%3C/svg%3E" 
                                 alt="Qu·ª≥nh" class="w-10 h-10 rounded-full">
                            <div>
                                <h3 class="font-medium">Qu·ª≥nh Anh</h3>
                                <p class="text-sm text-gray-500">Ho·∫°t ƒë·ªông 2 gi·ªù tr∆∞·ªõc</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6 flex space-x-3">
                        <button onclick="closeNewChatModal()" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                            H·ªßy
                        </button>
                        <button class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                            T·∫°o cu·ªôc tr√≤ chuy·ªán
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Info Panel (Right Sidebar) -->
        <div id="chatInfoPanel" class="w-80 bg-white border-l border-gray-200 flex-col hidden">
            <!-- Panel Header -->
            <div class="p-4 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h2 class="text-lg font-semibold">Th√¥ng tin ƒëo·∫°n chat</h2>
                    <button onclick="toggleChatInfoPanel()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- Profile Section -->
            <div class="p-4 text-center border-b border-gray-200">
                <img id="panelChatAvatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Ccircle cx='40' cy='40' r='40' fill='%23FF6B9D'/%3E%3Ctext x='40' y='50' text-anchor='middle' fill='white' font-size='32' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                     alt="Mai" class="w-20 h-20 rounded-full mx-auto mb-3">
                <h3 id="panelChatName" class="text-xl font-semibold">Mai Nguy·ªÖn</h3>
                <p id="panelChatStatus" class="text-green-600 text-sm">ƒêang ho·∫°t ƒë·ªông</p>
                <div class="flex justify-center space-x-4 mt-4">
                    <button onclick="startVoiceCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-phone text-blue-600"></i>
                    </button>
                    <button onclick="startVideoCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-video text-blue-600"></i>
                    </button>
                    <button class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-user-plus text-blue-600"></i>
                    </button>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="flex-1 overflow-y-auto">
                <div class="p-4 space-y-2">
                    <button onclick="showChatSearch()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-search text-gray-600"></i>
                            <span>T√¨m ki·∫øm trong ƒëo·∫°n chat</span>
                        </div>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-bell text-gray-600"></i>
                            <span>T·∫Øt th√¥ng b√°o</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox">
                            <span class="slider round bg-gray-300 w-10 h-5 rounded-full relative inline-block">
                                <span class="dot absolute w-3 h-3 bg-white rounded-full top-1 left-1 transition-transform"></span>
                            </span>
                        </label>
                    </button>
                    
                    <button onclick="showThemeModal()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-palette text-gray-600"></i>
                            <span>ƒê·ªïi ch·ªß ƒë·ªÅ</span>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-thumbs-up text-gray-600"></i>
                            <span>ƒê·ªïi bi·ªÉu t∆∞·ª£ng c·∫£m x√∫c</span>
                        </div>
                        <span class="text-2xl">üëç</span>
                    </button>
                </div>

                <!-- Shared Files Section -->
                <div class="p-4 border-t border-gray-200">
                    <h4 class="font-semibold text-gray-900 mb-3">T√†i li·ªáu ƒë√£ chia s·∫ª</h4>
                    <div class="space-y-2 max-h-40 overflow-y-auto">
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                            <i class="fas fa-file-pdf text-red-600 text-xl"></i>
                            <div class="flex-1">
                                <p class="text-sm font-medium">B√°o c√°o th√°ng 11.pdf</p>
                                <p class="text-xs text-gray-500">2.3 MB ‚Ä¢ 3 ng√†y tr∆∞·ªõc</p>
                            </div>
                            <button class="p-1 hover:bg-gray-200 rounded">
                                <i class="fas fa-download text-gray-600"></i>
                            </button>
                        </div>
                        
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                            <i class="fas fa-image text-green-600 text-xl"></i>
                            <div class="flex-1">
                                <p class="text-sm font-medium">IMG_2024.jpg</p>
                                <p class="text-xs text-gray-500">1.8 MB ‚Ä¢ 1 tu·∫ßn tr∆∞·ªõc</p>
                            </div>
                            <button class="p-1 hover:bg-gray-200 rounded">
                                <i class="fas fa-download text-gray-600"></i>
                            </button>
                        </div>
                    </div>
                    <button class="w-full text-center text-blue-600 text-sm py-2 hover:bg-gray-50 rounded-lg mt-2">
                        Xem t·∫•t c·∫£ t√†i li·ªáu
                    </button>
                </div>

                <!-- Privacy & Support -->
                <div class="p-4 border-t border-gray-200 space-y-2">
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-shield-alt text-gray-600"></i>
                            <span>Quy·ªÅn ri√™ng t∆∞ & h·ªó tr·ª£</span>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg text-red-600">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-ban"></i>
                            <span>Ch·∫∑n</span>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Room Modal -->
    <div id="roomModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center h-full">
            <div class="bg-white rounded-lg w-96">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-semibold">Cu·ªôc h·ªçp</h2>
                        <button onclick="closeRoomModal()" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <button onclick="createRoom()" class="w-full flex items-center space-x-3 p-4 border-2 border-dashed border-blue-300 rounded-lg hover:border-blue-500 hover:bg-blue-50">
                            <i class="fas fa-video text-blue-600 text-2xl"></i>
                            <div class="text-left">
                                <h3 class="font-medium text-blue-600">T·∫°o cu·ªôc h·ªçp m·ªõi</h3>
                                <p class="text-sm text-gray-500">B·∫Øt ƒë·∫ßu cu·ªôc h·ªçp ngay l·∫≠p t·ª©c</p>
                            </div>
                        </button>
                        
                        <button onclick="showScheduleMeeting()" class="w-full flex items-center space-x-3 p-4 border-2 border-dashed border-green-300 rounded-lg hover:border-green-500 hover:bg-green-50">
                            <i class="fas fa-calendar-plus text-green-600 text-2xl"></i>
                            <div class="text-left">
                                <h3 class="font-medium text-green-600">L·∫≠p l·ªãch cu·ªôc h·ªçp</h3>
                                <p class="text-sm text-gray-500">ƒê·∫∑t l·ªãch h·ªçp cho sau</p>
                            </div>
                        </button>
                        
                        <div class="relative">
                            <div class="absolute inset-0 flex items-center">
                                <div class="w-full border-t border-gray-300"></div>
                            </div>
                            <div class="relative flex justify-center text-sm">
                                <span class="px-2 bg-white text-gray-500">ho·∫∑c</span>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tham gia b·∫±ng m√£ cu·ªôc h·ªçp</label>
                            <div class="flex space-x-2">
                                <input id="roomCodeInput" type="text" placeholder="Nh·∫≠p m√£ cu·ªôc h·ªçp..." 
                                       class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <button onclick="joinRoom()" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                                    Tham gia
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Info Panel (Right Sidebar) -->
        <div id="chatInfoPanel" class="w-80 bg-white border-l border-gray-200 flex-col hidden">
            <!-- Panel Header -->
            <div class="p-4 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h2 class="text-lg font-semibold">Th√¥ng tin ƒëo·∫°n chat</h2>
                    <button onclick="toggleChatInfoPanel()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- Profile Section -->
            <div class="p-4 text-center border-b border-gray-200">
                <img id="panelChatAvatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Ccircle cx='40' cy='40' r='40' fill='%23FF6B9D'/%3E%3Ctext x='40' y='50' text-anchor='middle' fill='white' font-size='32' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                     alt="Mai" class="w-20 h-20 rounded-full mx-auto mb-3">
                <h3 id="panelChatName" class="text-xl font-semibold">Mai Nguy·ªÖn</h3>
                <p id="panelChatStatus" class="text-green-600 text-sm">ƒêang ho·∫°t ƒë·ªông</p>
                <div class="flex justify-center space-x-4 mt-4">
                    <button onclick="startVoiceCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-phone text-blue-600"></i>
                    </button>
                    <button onclick="startVideoCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-video text-blue-600"></i>
                    </button>
                    <button class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-user-plus text-blue-600"></i>
                    </button>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="flex-1 overflow-y-auto">
                <div class="p-4 space-y-2">
                    <button onclick="showChatSearch()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-search text-gray-600"></i>
                            <span>T√¨m ki·∫øm trong ƒëo·∫°n chat</span>
                        </div>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-bell text-gray-600"></i>
                            <span>T·∫Øt th√¥ng b√°o</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox">
                            <span class="slider round bg-gray-300 w-10 h-5 rounded-full relative inline-block">
                                <span class="dot absolute w-3 h-3 bg-white rounded-full top-1 left-1 transition-transform"></span>
                            </span>
                        </label>
                    </button>
                    
                    <button onclick="showThemeModal()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-palette text-gray-600"></i>
                            <span>ƒê·ªïi ch·ªß ƒë·ªÅ</span>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-thumbs-up text-gray-600"></i>
                            <span>ƒê·ªïi bi·ªÉu t∆∞·ª£ng c·∫£m x√∫c</span>
                        </div>
                        <span class="text-2xl">üëç</span>
                    </button>
                </div>

                <!-- Shared Files Section -->
                <div class="p-4 border-t border-gray-200">
                    <h4 class="font-semibold text-gray-900 mb-3">T√†i li·ªáu ƒë√£ chia s·∫ª</h4>
                    <div class="space-y-2 max-h-40 overflow-y-auto">
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                            <i class="fas fa-file-pdf text-red-600 text-xl"></i>
                            <div class="flex-1">
                                <p class="text-sm font-medium">B√°o c√°o th√°ng 11.pdf</p>
                                <p class="text-xs text-gray-500">2.3 MB ‚Ä¢ 3 ng√†y tr∆∞·ªõc</p>
                            </div>
                            <button class="p-1 hover:bg-gray-200 rounded">
                                <i class="fas fa-download text-gray-600"></i>
                            </button>
                        </div>
                        
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                            <i class="fas fa-image text-green-600 text-xl"></i>
                            <div class="flex-1">
                                <p class="text-sm font-medium">IMG_2024.jpg</p>
                                <p class="text-xs text-gray-500">1.8 MB ‚Ä¢ 1 tu·∫ßn tr∆∞·ªõc</p>
                            </div>
                            <button class="p-1 hover:bg-gray-200 rounded">
                                <i class="fas fa-download text-gray-600"></i>
                            </button>
                        </div>
                    </div>
                    <button class="w-full text-center text-blue-600 text-sm py-2 hover:bg-gray-50 rounded-lg mt-2">
                        Xem t·∫•t c·∫£ t√†i li·ªáu
                    </button>
                </div>

                <!-- Privacy & Support -->
                <div class="p-4 border-t border-gray-200 space-y-2">
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-shield-alt text-gray-600"></i>
                            <span>Quy·ªÅn ri√™ng t∆∞ & h·ªó tr·ª£</span>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg text-red-600">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-ban"></i>
                            <span>Ch·∫∑n</span>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Meeting Room Modal -->
    <div id="meetingRoomModal" class="fixed inset-0 bg-gray-900 z-50 hidden">
        <div class="h-full flex flex-col">
            <!-- Meeting Header -->
            <div class="bg-gray-800 p-4 flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <h2 class="text-white text-lg font-semibold">Cu·ªôc h·ªçp</h2>
                    <div class="flex items-center space-x-2 text-gray-300">
                        <i class="fas fa-clock text-sm"></i>
                        <span id="meetingDuration" class="text-sm">00:00</span>
                    </div>
                    <div class="flex items-center space-x-2 bg-gray-700 px-3 py-1 rounded-full">
                        <i class="fas fa-key text-green-400 text-xs"></i>
                        <span id="currentRoomCode" class="text-white text-sm font-mono">ABC123</span>
                        <button onclick="copyMeetingLink()" class="text-gray-300 hover:text-white ml-2">
                            <i class="fas fa-copy text-xs"></i>
                        </button>
                    </div>
                </div>
                
                <div class="flex items-center space-x-2">
                    <button onclick="showParticipants()" class="text-gray-300 hover:text-white p-2 rounded-lg hover:bg-gray-700">
                        <i class="fas fa-users"></i>
                        <span class="ml-1 text-sm">4</span>
                    </button>
                    <button onclick="showMeetingChat()" class="text-gray-300 hover:text-white p-2 rounded-lg hover:bg-gray-700">
                        <i class="fas fa-comment"></i>
                    </button>
                    <button onclick="inviteToMeeting()" class="bg-blue-600 text-white px-3 py-2 rounded-lg hover:bg-blue-700 text-sm">
                        <i class="fas fa-user-plus mr-1"></i>
                        M·ªùi th√™m
                    </button>
                    <button onclick="showMeetingSettings()" class="text-gray-300 hover:text-white p-2 rounded-lg hover:bg-gray-700">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>
            
            <!-- Video Grid -->
            <div class="flex-1 p-4">
                <div class="grid grid-cols-3 grid-rows-2 gap-4 h-full">
                    <!-- Main Speaker -->
                    <div class="col-span-2 row-span-2 bg-gray-800 rounded-lg relative overflow-hidden">
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="text-center">
                                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Ccircle cx='40' cy='40' r='40' fill='%23FF6B9D'/%3E%3Ctext x='40' y='50' text-anchor='middle' fill='white' font-size='32' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                                     alt="Mai" class="w-20 h-20 rounded-full mx-auto mb-2">
                                <h3 class="text-white font-semibold">Mai Nguy·ªÖn</h3>
                            </div>
                        </div>
                        <div class="absolute bottom-4 left-4 flex items-center space-x-2">
                            <div class="bg-black bg-opacity-50 px-2 py-1 rounded text-white text-sm">Mai Nguy·ªÖn</div>
                            <i class="fas fa-microphone-slash text-red-500"></i>
                        </div>
                    </div>
                    
                    <!-- Participant 1 -->
                    <div class="bg-gray-800 rounded-lg relative overflow-hidden">
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="text-center">
                                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60' viewBox='0 0 60 60'%3E%3Ccircle cx='30' cy='30' r='30' fill='%234A90E2'/%3E%3Ctext x='30' y='38' text-anchor='middle' fill='white' font-size='24' font-weight='bold'%3ED%3C/text%3E%3C/svg%3E" 
                                     alt="ƒê·ª©c" class="w-15 h-15 rounded-full mx-auto mb-1">
                                <h4 class="text-white text-sm">ƒê·ª©c Tr·∫ßn</h4>
                            </div>
                        </div>
                        <div class="absolute bottom-2 left-2">
                            <div class="bg-black bg-opacity-50 px-2 py-1 rounded text-white text-xs">ƒê·ª©c Tr·∫ßn</div>
                        </div>
                    </div>
                    
                    <!-- Participant 2 -->
                    <div class="bg-gray-800 rounded-lg relative overflow-hidden">
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="text-center">
                                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60' viewBox='0 0 60 60'%3E%3Ccircle cx='30' cy='30' r='30' fill='%23F39C12'/%3E%3Ctext x='30' y='38' text-anchor='middle' fill='white' font-size='24' font-weight='bold'%3EL%3C/text%3E%3C/svg%3E" 
                                     alt="Linh" class="w-15 h-15 rounded-full mx-auto mb-1">
                                <h4 class="text-white text-sm">Linh V√µ</h4>
                            </div>
                        </div>
                        <div class="absolute bottom-2 left-2 flex items-center space-x-1">
                            <div class="bg-black bg-opacity-50 px-2 py-1 rounded text-white text-xs">Linh V√µ</div>
                            <i class="fas fa-microphone text-green-500 text-xs"></i>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Meeting Controls -->
            <div class="bg-gray-800 p-4">
                <div class="flex justify-center items-center space-x-4">
                    <button id="meetingMuteBtn" onclick="toggleMeetingMute()" class="w-12 h-12 bg-red-600 rounded-full flex items-center justify-center hover:bg-red-700 transition-colors">
                        <i class="fas fa-microphone-slash text-white"></i>
                    </button>
                    <button id="meetingVideoBtn" onclick="toggleMeetingVideo()" class="w-12 h-12 bg-red-600 rounded-full flex items-center justify-center hover:bg-red-700 transition-colors">
                        <i class="fas fa-video-slash text-white"></i>
                    </button>
                    <button onclick="toggleMeetingScreenShare()" class="w-12 h-12 bg-gray-600 rounded-full flex items-center justify-center hover:bg-gray-500 transition-colors">
                        <i class="fas fa-desktop text-white"></i>
                    </button>
                    <button onclick="endMeeting()" class="w-12 h-12 bg-red-600 rounded-full flex items-center justify-center hover:bg-red-700 transition-colors">
                        <i class="fas fa-phone-slash text-white"></i>
                    </button>
                    <button onclick="minimizeMeeting()" class="w-12 h-12 bg-gray-600 rounded-full flex items-center justify-center hover:bg-gray-500 transition-colors">
                        <i class="fas fa-minus text-white"></i>
                    </button>
                    <button onclick="shareRoomCode()" class="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center hover:bg-blue-700 transition-colors">
                        <i class="fas fa-share text-white"></i>
                    </button>
                </div>
                
                <div class="flex justify-center mt-3 text-gray-400 text-sm">
                    <span>M√£ cu·ªôc h·ªçp: <span id="displayRoomCode" class="font-mono text-white">ABC123</span></span>
                </div>
            </div>
        </div>

        <!-- Chat Info Panel (Right Sidebar) -->
        <div id="chatInfoPanel" class="w-80 bg-white border-l border-gray-200 flex-col hidden">
            <!-- Panel Header -->
            <div class="p-4 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h2 class="text-lg font-semibold">Th√¥ng tin ƒëo·∫°n chat</h2>
                    <button onclick="toggleChatInfoPanel()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- Profile Section -->
            <div class="p-4 text-center border-b border-gray-200">
                <img id="panelChatAvatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Ccircle cx='40' cy='40' r='40' fill='%23FF6B9D'/%3E%3Ctext x='40' y='50' text-anchor='middle' fill='white' font-size='32' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                     alt="Mai" class="w-20 h-20 rounded-full mx-auto mb-3">
                <h3 id="panelChatName" class="text-xl font-semibold">Mai Nguy·ªÖn</h3>
                <p id="panelChatStatus" class="text-green-600 text-sm">ƒêang ho·∫°t ƒë·ªông</p>
                <div class="flex justify-center space-x-4 mt-4">
                    <button onclick="startVoiceCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-phone text-blue-600"></i>
                    </button>
                    <button onclick="startVideoCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-video text-blue-600"></i>
                    </button>
                    <button class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-user-plus text-blue-600"></i>
                    </button>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="flex-1 overflow-y-auto">
                <div class="p-4 space-y-2">
                    <button onclick="showChatSearch()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-search text-gray-600"></i>
                            <span>T√¨m ki·∫øm trong ƒëo·∫°n chat</span>
                        </div>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-bell text-gray-600"></i>
                            <span>T·∫Øt th√¥ng b√°o</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox">
                            <span class="slider round bg-gray-300 w-10 h-5 rounded-full relative inline-block">
                                <span class="dot absolute w-3 h-3 bg-white rounded-full top-1 left-1 transition-transform"></span>
                            </span>
                        </label>
                    </button>
                    
                    <button onclick="showThemeModal()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-palette text-gray-600"></i>
                            <span>ƒê·ªïi ch·ªß ƒë·ªÅ</span>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-thumbs-up text-gray-600"></i>
                            <span>ƒê·ªïi bi·ªÉu t∆∞·ª£ng c·∫£m x√∫c</span>
                        </div>
                        <span class="text-2xl">üëç</span>
                    </button>
                </div>

                <!-- Shared Files Section -->
                <div class="p-4 border-t border-gray-200">
                    <h4 class="font-semibold text-gray-900 mb-3">T√†i li·ªáu ƒë√£ chia s·∫ª</h4>
                    <div class="space-y-2 max-h-40 overflow-y-auto">
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                            <i class="fas fa-file-pdf text-red-600 text-xl"></i>
                            <div class="flex-1">
                                <p class="text-sm font-medium">B√°o c√°o th√°ng 11.pdf</p>
                                <p class="text-xs text-gray-500">2.3 MB ‚Ä¢ 3 ng√†y tr∆∞·ªõc</p>
                            </div>
                            <button class="p-1 hover:bg-gray-200 rounded">
                                <i class="fas fa-download text-gray-600"></i>
                            </button>
                        </div>
                        
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                            <i class="fas fa-image text-green-600 text-xl"></i>
                            <div class="flex-1">
                                <p class="text-sm font-medium">IMG_2024.jpg</p>
                                <p class="text-xs text-gray-500">1.8 MB ‚Ä¢ 1 tu·∫ßn tr∆∞·ªõc</p>
                            </div>
                            <button class="p-1 hover:bg-gray-200 rounded">
                                <i class="fas fa-download text-gray-600"></i>
                            </button>
                        </div>
                    </div>
                    <button class="w-full text-center text-blue-600 text-sm py-2 hover:bg-gray-50 rounded-lg mt-2">
                        Xem t·∫•t c·∫£ t√†i li·ªáu
                    </button>
                </div>

                <!-- Privacy & Support -->
                <div class="p-4 border-t border-gray-200 space-y-2">
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-shield-alt text-gray-600"></i>
                            <span>Quy·ªÅn ri√™ng t∆∞ & h·ªó tr·ª£</span>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg text-red-600">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-ban"></i>
                            <span>Ch·∫∑n</span>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Invite to Meeting Modal -->
    <div id="inviteMeetingModal" class="fixed inset-0 bg-black bg-opacity-50 z-60 hidden">
        <div class="flex items-center justify-center h-full">
            <div class="bg-white rounded-lg w-96 max-h-[80vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-semibold">M·ªùi tham gia cu·ªôc h·ªçp</h2>
                        <button onclick="closeInviteMeeting()" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <!-- Meeting Info -->
                    <div class="bg-blue-50 p-4 rounded-lg mb-6">
                        <div class="flex items-center space-x-2 mb-2">
                            <i class="fas fa-video text-blue-600"></i>
                            <span class="font-medium">Cu·ªôc h·ªçp ƒëang di·ªÖn ra</span>
                        </div>
                        <div class="text-sm text-gray-600 space-y-1">
                            <div>M√£ cu·ªôc h·ªçp: <span class="font-mono font-semibold">ABC123</span></div>
                            <div>Link: <span class="text-blue-600">https://meet.app/ABC123</span></div>
                        </div>
                        <div class="flex space-x-2 mt-3">
                            <button onclick="copyMeetingLink()" class="flex-1 bg-blue-600 text-white px-3 py-2 rounded text-sm hover:bg-blue-700">
                                <i class="fas fa-copy mr-1"></i>
                                Sao ch√©p link
                            </button>
                            <button onclick="shareRoomCode()" class="flex-1 bg-gray-600 text-white px-3 py-2 rounded text-sm hover:bg-gray-700">
                                <i class="fas fa-share mr-1"></i>
                                Chia s·∫ª
                            </button>
                        </div>
                    </div>
                    
                    <!-- Contact List -->
                    <div class="mb-4">
                        <h3 class="font-medium mb-3">M·ªùi t·ª´ danh b·∫°</h3>
                        <div class="space-y-2 max-h-60 overflow-y-auto">
                            <div class="flex items-center justify-between p-2 hover:bg-gray-50 rounded-lg">
                                <div class="flex items-center space-x-3">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%2327AE60'/%3E%3Ctext x='16' y='21' text-anchor='middle' fill='white' font-size='14' font-weight='bold'%3EA%3C/text%3E%3C/svg%3E" 
                                         alt="An" class="w-8 h-8 rounded-full">
                                    <div>
                                        <h4 class="font-medium text-sm">An L√™</h4>
                                        <p class="text-xs text-gray-500">ƒêang ho·∫°t ƒë·ªông</p>
                                    </div>
                                </div>
                                <button onclick="inviteUser('An L√™')" class="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                    M·ªùi
                                </button>
                            </div>
                            
                            <div class="flex items-center justify-between p-2 hover:bg-gray-50 rounded-lg">
                                <div class="flex items-center space-x-3">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%23E74C3C'/%3E%3Ctext x='16' y='21' text-anchor='middle' fill='white' font-size='14' font-weight='bold'%3EH%3C/text%3E%3C/svg%3E" 
                                         alt="Hoa" class="w-8 h-8 rounded-full">
                                    <div>
                                        <h4 class="font-medium text-sm">Hoa Ph·∫°m</h4>
                                        <p class="text-xs text-gray-500">Ho·∫°t ƒë·ªông 5 ph√∫t tr∆∞·ªõc</p>
                                    </div>
                                </div>
                                <button onclick="inviteUser('Hoa Ph·∫°m')" class="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                    M·ªùi
                                </button>
                            </div>
                            
                            <div class="flex items-center justify-between p-2 hover:bg-gray-50 rounded-lg">
                                <div class="flex items-center space-x-3">
                                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%23FF9500'/%3E%3Ctext x='16' y='21' text-anchor='middle' fill='white' font-size='14' font-weight='bold'%3EN%3C/text%3E%3C/svg%3E" 
                                         alt="Nam" class="w-8 h-8 rounded-full">
                                    <div>
                                        <h4 class="font-medium text-sm">Nam V≈©</h4>
                                        <p class="text-xs text-gray-500">Ho·∫°t ƒë·ªông 1 gi·ªù tr∆∞·ªõc</p>
                                    </div>
                                </div>
                                <button onclick="inviteUser('Nam V≈©')" class="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700">
                                    M·ªùi
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Info Panel (Right Sidebar) -->
        <div id="chatInfoPanel" class="w-80 bg-white border-l border-gray-200 flex-col hidden">
            <!-- Panel Header -->
            <div class="p-4 border-b border-gray-200">
                <div class="flex justify-between items-center">
                    <h2 class="text-lg font-semibold">Th√¥ng tin ƒëo·∫°n chat</h2>
                    <button onclick="toggleChatInfoPanel()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- Profile Section -->
            <div class="p-4 text-center border-b border-gray-200">
                <img id="panelChatAvatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Ccircle cx='40' cy='40' r='40' fill='%23FF6B9D'/%3E%3Ctext x='40' y='50' text-anchor='middle' fill='white' font-size='32' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                     alt="Mai" class="w-20 h-20 rounded-full mx-auto mb-3">
                <h3 id="panelChatName" class="text-xl font-semibold">Mai Nguy·ªÖn</h3>
                <p id="panelChatStatus" class="text-green-600 text-sm">ƒêang ho·∫°t ƒë·ªông</p>
                <div class="flex justify-center space-x-4 mt-4">
                    <button onclick="startVoiceCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-phone text-blue-600"></i>
                    </button>
                    <button onclick="startVideoCall()" class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-video text-blue-600"></i>
                    </button>
                    <button class="p-3 bg-gray-100 rounded-full hover:bg-gray-200">
                        <i class="fas fa-user-plus text-blue-600"></i>
                    </button>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="flex-1 overflow-y-auto">
                <div class="p-4 space-y-2">
                    <button onclick="showChatSearch()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-search text-gray-600"></i>
                            <span>T√¨m ki·∫øm trong ƒëo·∫°n chat</span>
                        </div>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-bell text-gray-600"></i>
                            <span>T·∫Øt th√¥ng b√°o</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox">
                            <span class="slider round bg-gray-300 w-10 h-5 rounded-full relative inline-block">
                                <span class="dot absolute w-3 h-3 bg-white rounded-full top-1 left-1 transition-transform"></span>
                            </span>
                        </label>
                    </button>
                    
                    <button onclick="showThemeModal()" class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-palette text-gray-600"></i>
                            <span>ƒê·ªïi ch·ªß ƒë·ªÅ</span>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-thumbs-up text-gray-600"></i>
                            <span>ƒê·ªïi bi·ªÉu t∆∞·ª£ng c·∫£m x√∫c</span>
                        </div>
                        <span class="text-2xl">üëç</span>
                    </button>
                </div>

                <!-- Shared Files Section -->
                <div class="p-4 border-t border-gray-200">
                    <h4 class="font-semibold text-gray-900 mb-3">T√†i li·ªáu ƒë√£ chia s·∫ª</h4>
                    <div class="space-y-2 max-h-40 overflow-y-auto">
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                            <i class="fas fa-file-pdf text-red-600 text-xl"></i>
                            <div class="flex-1">
                                <p class="text-sm font-medium">B√°o c√°o th√°ng 11.pdf</p>
                                <p class="text-xs text-gray-500">2.3 MB ‚Ä¢ 3 ng√†y tr∆∞·ªõc</p>
                            </div>
                            <button class="p-1 hover:bg-gray-200 rounded">
                                <i class="fas fa-download text-gray-600"></i>
                            </button>
                        </div>
                        
                        <div class="flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg">
                            <i class="fas fa-image text-green-600 text-xl"></i>
                            <div class="flex-1">
                                <p class="text-sm font-medium">IMG_2024.jpg</p>
                                <p class="text-xs text-gray-500">1.8 MB ‚Ä¢ 1 tu·∫ßn tr∆∞·ªõc</p>
                            </div>
                            <button class="p-1 hover:bg-gray-200 rounded">
                                <i class="fas fa-download text-gray-600"></i>
                            </button>
                        </div>
                    </div>
                    <button class="w-full text-center text-blue-600 text-sm py-2 hover:bg-gray-50 rounded-lg mt-2">
                        Xem t·∫•t c·∫£ t√†i li·ªáu
                    </button>
                </div>

                <!-- Privacy & Support -->
                <div class="p-4 border-t border-gray-200 space-y-2">
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-shield-alt text-gray-600"></i>
                            <span>Quy·ªÅn ri√™ng t∆∞ & h·ªó tr·ª£</span>
                        </div>
                        <i class="fas fa-chevron-right text-gray-400"></i>
                    </button>
                    
                    <button class="w-full flex items-center justify-between py-3 px-4 hover:bg-gray-50 rounded-lg text-red-600">
                        <div class="flex items-center space-x-3">
                            <i class="fas fa-ban"></i>
                            <span>Ch·∫∑n</span>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Schedule Meeting Modal -->
    <div id="scheduleMeetingModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center h-full">
            <div class="bg-white rounded-lg w-[500px] max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-semibold">L·∫≠p l·ªãch cu·ªôc h·ªçp</h2>
                        <button onclick="closeScheduleMeeting()" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <form class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ti√™u ƒë·ªÅ cu·ªôc h·ªçp</label>
                            <input type="text" placeholder="Nh·∫≠p ti√™u ƒë·ªÅ cu·ªôc h·ªçp..." 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Ng√†y</label>
                                <input type="date" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Gi·ªù</label>
                                <input type="time" 
                                       class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Th·ªùi l∆∞·ª£ng</label>
                            <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option>30 ph√∫t</option>
                                <option>1 gi·ªù</option>
                                <option>1.5 gi·ªù</option>
                                <option>2 gi·ªù</option>
                                <option>T√πy ch·ªânh</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">M√¥ t·∫£ (t√πy ch·ªçn)</label>
                            <textarea placeholder="Th√™m m√¥ t·∫£ v·ªÅ cu·ªôc h·ªçp..." rows="3"
                                      class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">M·ªùi ng∆∞·ªùi tham gia</label>
                            <div class="space-y-2 max-h-32 overflow-y-auto border border-gray-200 rounded-lg p-2">
                                <div class="flex items-center space-x-2">
                                    <input type="checkbox" id="invite-mai" class="rounded">
                                    <label for="invite-mai" class="flex items-center space-x-2 flex-1">
                                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Ccircle cx='12' cy='12' r='12' fill='%23FF6B9D'/%3E%3Ctext x='12' y='16' text-anchor='middle' fill='white' font-size='10' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                                             alt="Mai" class="w-6 h-6 rounded-full">
                                        <span class="text-sm">Mai Nguy·ªÖn</span>
                                    </label>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <input type="checkbox" id="invite-duc" class="rounded">
                                    <label for="invite-duc" class="flex items-center space-x-2 flex-1">
                                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Ccircle cx='12' cy='12' r='12' fill='%234A90E2'/%3E%3Ctext x='12' y='16' text-anchor='middle' fill='white' font-size='10' font-weight='bold'%3ED%3C/text%3E%3C/svg%3E" 
                                             alt="ƒê·ª©c" class="w-6 h-6 rounded-full">
                                        <span class="text-sm">ƒê·ª©c Tr·∫ßn</span>
                                    </label>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <input type="checkbox" id="invite-linh" class="rounded">
                                    <label for="invite-linh" class="flex items-center space-x-2 flex-1">
                                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Ccircle cx='12' cy='12' r='12' fill='%23F39C12'/%3E%3Ctext x='12' y='16' text-anchor='middle' fill='white' font-size='10' font-weight='bold'%3EL%3C/text%3E%3C/svg%3E" 
                                             alt="Linh" class="w-6 h-6 rounded-full">
                                        <span class="text-sm">Linh V√µ</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex items-center space-x-2">
                            <input type="checkbox" id="send-notification" class="rounded" checked>
                            <label for="send-notification" class="text-sm text-gray-700">G·ª≠i th√¥ng b√°o nh·∫Øc nh·ªü</label>
                        </div>
                        
                        <div class="flex space-x-3 pt-4">
                            <button type="button" onclick="closeScheduleMeeting()" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                                H·ªßy
                            </button>
                            <button type="button" onclick="scheduleMeeting()" class="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                                L·∫≠p l·ªãch
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Minimized Meeting Window -->
    <div id="minimizedMeeting" class="fixed bottom-4 right-4 bg-gray-800 rounded-lg p-4 w-80 hidden z-40">
        <div class="flex items-center justify-between mb-3">
            <div class="flex items-center space-x-2">
                <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                <span class="text-white text-sm font-medium">Cu·ªôc h·ªçp ƒëang di·ªÖn ra</span>
            </div>
            <div class="flex space-x-1">
                <button onclick="maximizeMeeting()" class="text-gray-300 hover:text-white p-1">
                    <i class="fas fa-expand text-sm"></i>
                </button>
                <button onclick="endMeeting()" class="text-red-400 hover:text-red-300 p-1">
                    <i class="fas fa-times text-sm"></i>
                </button>
            </div>
        </div>
        
        <div class="grid grid-cols-3 gap-2 mb-3">
            <div class="bg-gray-700 rounded aspect-video flex items-center justify-center">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%23FF6B9D'/%3E%3Ctext x='16' y='21' text-anchor='middle' fill='white' font-size='14' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                     alt="Mai" class="w-8 h-8 rounded-full">
            </div>
            <div class="bg-gray-700 rounded aspect-video flex items-center justify-center">
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='32' height='32' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%234A90E2'/%3E%3Ctext x='16' y='21' text-anchor='middle' fill='white' font-size='14' font-weight='bold'%3ED%3C/text%3E%3C/svg%3E" 
                     alt="ƒê·ª©c" class="w-8 h-8 rounded-full">
            </div>
            <div class="bg-gray-700 rounded aspect-video flex items-center justify-center">
                <i class="fas fa-user text-gray-400"></i>
            </div>
        </div>
        
        <div class="flex justify-center space-x-2">
            <button id="miniMuteBtn" onclick="toggleMeetingMute()" class="w-8 h-8 bg-red-600 rounded-full flex items-center justify-center">
                <i class="fas fa-microphone-slash text-white text-xs"></i>
            </button>
            <button id="miniVideoBtn" onclick="toggleMeetingVideo()" class="w-8 h-8 bg-red-600 rounded-full flex items-center justify-center">
                <i class="fas fa-video-slash text-white text-xs"></i>
            </button>
        </div>
        
        <div class="text-center mt-2">
            <span id="miniMeetingDuration" class="text-gray-300 text-xs">00:00</span>
        </div>
    </div>

    <script>
        let currentChat = 'mai';
        let originalMessages = [];
        
        function selectChat(chatId) {
            currentChat = chatId;
            // Remove active state from all chat items
            document.querySelectorAll('.chat-item').forEach(item => {
                item.classList.remove('border-l-4', 'border-blue-500', 'bg-blue-50');
            });
            
            // Add active state to selected chat
            event.currentTarget.classList.add('border-l-4', 'border-blue-500', 'bg-blue-50');
            
            // Update chat header and messages based on selected chat
            updateChatContent(chatId);
        }
        
        function updateChatContent(chatId) {
            const chatData = {
                'mai': {
                    name: 'Mai Nguy·ªÖn',
                    avatar: 'M',
                    color: '#FF6B9D',
                    status: 'ƒêang ho·∫°t ƒë·ªông'
                },
                'duc': {
                    name: 'ƒê·ª©c Tr·∫ßn',
                    avatar: 'D',
                    color: '#4A90E2',
                    status: 'Ho·∫°t ƒë·ªông 5 ph√∫t tr∆∞·ªõc'
                },
                'linh': {
                    name: 'Linh V√µ',
                    avatar: 'L',
                    color: '#F39C12',
                    status: 'Ho·∫°t ƒë·ªông 1 gi·ªù tr∆∞·ªõc'
                },
                'group': {
                    name: 'Nh√≥m B·∫°n Th√¢n',
                    avatar: 'Nh√≥m',
                    color: '#9B59B6',
                    status: '5 th√†nh vi√™n'
                },
                'an': {
                    name: 'An L√™',
                    avatar: 'A',
                    color: '#27AE60',
                    status: 'Ho·∫°t ƒë·ªông 5 gi·ªù tr∆∞·ªõc'
                },
                'hoa': {
                    name: 'Hoa Ph·∫°m',
                    avatar: 'H',
                    color: '#E74C3C',
                    status: 'ƒêang ho·∫°t ƒë·ªông'
                },
                'work': {
                    name: 'Nh√≥m C√¥ng Vi·ªác',
                    avatar: 'Work',
                    color: '#34495E',
                    status: '8 th√†nh vi√™n'
                },
                'nam': {
                    name: 'Nam V≈©',
                    avatar: 'N',
                    color: '#FF9500',
                    status: 'Ho·∫°t ƒë·ªông 1 tu·∫ßn tr∆∞·ªõc'
                },
                'family': {
                    name: 'Gia ƒê√¨nh',
                    avatar: 'Gƒê',
                    color: '#E91E63',
                    status: '4 th√†nh vi√™n'
                },
                'study': {
                    name: 'Nh√≥m H·ªçc T·∫≠p',
                    avatar: 'HT',
                    color: '#673AB7',
                    status: '12 th√†nh vi√™n'
                },
                'gaming': {
                    name: 'Gaming Squad',
                    avatar: 'GS',
                    color: '#FF5722',
                    status: '6 th√†nh vi√™n'
                },
                'travel': {
                    name: 'Du L·ªãch C√πng Nhau',
                    avatar: 'DL',
                    color: '#00BCD4',
                    status: '8 th√†nh vi√™n'
                },
                'food': {
                    name: 'H·ªôi ƒÇn U·ªëng',
                    avatar: 'AU',
                    color: '#FF9800',
                    status: '15 th√†nh vi√™n'
                },
                'sport': {
                    name: 'CLB Th·ªÉ Thao',
                    avatar: 'TT',
                    color: '#4CAF50',
                    status: '20 th√†nh vi√™n'
                }
            };
            
            const chat = chatData[chatId];
            if (chat) {
                // Update header
                document.getElementById('chatName').textContent = chat.name;
                document.getElementById('chatStatus').textContent = chat.status;
                
                // Update avatar
                const avatarSvg = `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Ccircle cx='20' cy='20' r='20' fill='${encodeURIComponent(chat.color)}'/%3E%3Ctext x='20' y='26' text-anchor='middle' fill='white' font-size='16' font-weight='bold'%3E${chat.avatar}%3C/text%3E%3C/svg%3E`;
                document.getElementById('chatAvatar').src = avatarSvg;
                
                // Update panel info if open
                updateChatInfoPanel(chat);
                
                // Clear messages and show typing indicator briefly
                showTypingIndicator();
                setTimeout(() => {
                    hideTypingIndicator();
                }, 1500);
            }
        }
        
        function updateChatInfoPanel(chat) {
            document.getElementById('panelChatName').textContent = chat.name;
            document.getElementById('panelChatStatus').textContent = chat.status;
            
            const panelAvatarSvg = `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Ccircle cx='40' cy='40' r='40' fill='${encodeURIComponent(chat.color)}'/%3E%3Ctext x='40' y='50' text-anchor='middle' fill='white' font-size='32' font-weight='bold'%3E${chat.avatar}%3C/text%3E%3C/svg%3E`;
            document.getElementById('panelChatAvatar').src = panelAvatarSvg;
        }
        
        function toggleChatInfoPanel() {
            const panel = document.getElementById('chatInfoPanel');
            const mainArea = document.getElementById('mainChatArea');
            
            if (panel.classList.contains('hidden')) {
                panel.classList.remove('hidden');
                panel.classList.add('flex');
                mainArea.style.marginRight = '320px';
                
                // Update panel with current chat info
                const chatData = {
                    'mai': { name: 'Mai Nguy·ªÖn', avatar: 'M', color: '#FF6B9D', status: 'ƒêang ho·∫°t ƒë·ªông' },
                    'duc': { name: 'ƒê·ª©c Tr·∫ßn', avatar: 'D', color: '#4A90E2', status: 'Ho·∫°t ƒë·ªông 5 ph√∫t tr∆∞·ªõc' },
                    'linh': { name: 'Linh V√µ', avatar: 'L', color: '#F39C12', status: 'Ho·∫°t ƒë·ªông 1 gi·ªù tr∆∞·ªõc' },
                    'group': { name: 'Nh√≥m B·∫°n Th√¢n', avatar: 'Nh√≥m', color: '#9B59B6', status: '5 th√†nh vi√™n' },
                    'an': { name: 'An L√™', avatar: 'A', color: '#27AE60', status: 'Ho·∫°t ƒë·ªông 5 gi·ªù tr∆∞·ªõc' },
                    'hoa': { name: 'Hoa Ph·∫°m', avatar: 'H', color: '#E74C3C', status: 'ƒêang ho·∫°t ƒë·ªông' },
                    'work': { name: 'Nh√≥m C√¥ng Vi·ªác', avatar: 'Work', color: '#34495E', status: '8 th√†nh vi√™n' },
                    'nam': { name: 'Nam V≈©', avatar: 'N', color: '#FF9500', status: 'Ho·∫°t ƒë·ªông 1 tu·∫ßn tr∆∞·ªõc' },
                    'family': { name: 'Gia ƒê√¨nh', avatar: 'Gƒê', color: '#E91E63', status: '4 th√†nh vi√™n' },
                    'study': { name: 'Nh√≥m H·ªçc T·∫≠p', avatar: 'HT', color: '#673AB7', status: '12 th√†nh vi√™n' },
                    'gaming': { name: 'Gaming Squad', avatar: 'GS', color: '#FF5722', status: '6 th√†nh vi√™n' },
                    'travel': { name: 'Du L·ªãch C√πng Nhau', avatar: 'DL', color: '#00BCD4', status: '8 th√†nh vi√™n' },
                    'food': { name: 'H·ªôi ƒÇn U·ªëng', avatar: 'AU', color: '#FF9800', status: '15 th√†nh vi√™n' },
                    'sport': { name: 'CLB Th·ªÉ Thao', avatar: 'TT', color: '#4CAF50', status: '20 th√†nh vi√™n' }
                };
                
                const chat = chatData[currentChat];
                if (chat) {
                    updateChatInfoPanel(chat);
                }
            } else {
                panel.classList.add('hidden');
                panel.classList.remove('flex');
                mainArea.style.marginRight = '0';
            }
        }
        
        // Search functions
        function searchChats(query) {
            const chatItems = document.querySelectorAll('.chat-item');
            chatItems.forEach(item => {
                const name = item.getAttribute('data-name').toLowerCase();
                const message = item.getAttribute('data-message').toLowerCase();
                const searchTerm = query.toLowerCase();
                
                if (name.includes(searchTerm) || message.includes(searchTerm)) {
                    item.style.display = 'block';
                } else {
                    item.style.display = query ? 'none' : 'block';
                }
            });
        }
        
        function showChatSearch() {
            document.getElementById('chatSearchBar').classList.remove('hidden');
            document.getElementById('chatSearchInput').focus();
            closeChatInfo();
        }
        
        function closeChatSearch() {
            document.getElementById('chatSearchBar').classList.add('hidden');
            document.getElementById('chatSearchInput').value = '';
            clearChatSearchHighlights();
        }
        
        function searchInChat(query) {
            const messages = document.querySelectorAll('#messagesContainer .message-bubble p');
            clearChatSearchHighlights();
            
            if (query.trim()) {
                messages.forEach(message => {
                    const text = message.textContent;
                    const regex = new RegExp(`(${query})`, 'gi');
                    const highlightedText = text.replace(regex, '<span class="chat-search-highlight">$1</span>');
                    message.innerHTML = highlightedText;
                });
            }
        }
        
        function clearChatSearchHighlights() {
            const highlights = document.querySelectorAll('.chat-search-highlight');
            highlights.forEach(highlight => {
                const parent = highlight.parentNode;
                parent.replaceChild(document.createTextNode(highlight.textContent), highlight);
                parent.normalize();
            });
        }
        
        // Modal functions
        function showNewChatModal() {
            document.getElementById('newChatModal').classList.remove('hidden');
        }
        
        function closeNewChatModal() {
            document.getElementById('newChatModal').classList.add('hidden');
        }
        
        function showRoomModal() {
            document.getElementById('roomModal').classList.remove('hidden');
        }
        
        function closeRoomModal() {
            document.getElementById('roomModal').classList.add('hidden');
        }
        
        let meetingTimer;
        let meetingStartTime;
        let currentRoomCode = '';
        let isMeetingMuted = true;
        let isMeetingVideoOn = false;
        let isMeetingScreenSharing = false;
        
        function createRoom() {
            currentRoomCode = Math.random().toString(36).substring(2, 8).toUpperCase();
            document.getElementById('currentRoomCode').textContent = currentRoomCode;
            closeRoomModal();
            startMeeting();
        }
        
        function joinRoom() {
            const roomCode = document.getElementById('roomCodeInput').value.trim();
            if (roomCode) {
                currentRoomCode = roomCode;
                document.getElementById('currentRoomCode').textContent = roomCode;
                closeRoomModal();
                startMeeting();
            } else {
                alert('Vui l√≤ng nh·∫≠p m√£ cu·ªôc h·ªçp!');
            }
        }
        
        function startMeeting() {
            document.getElementById('meetingRoomModal').classList.remove('hidden');
            startMeetingTimer();
        }
        
        function startMeetingTimer() {
            meetingStartTime = Date.now();
            meetingTimer = setInterval(() => {
                const elapsed = Math.floor((Date.now() - meetingStartTime) / 1000);
                const minutes = Math.floor(elapsed / 60).toString().padStart(2, '0');
                const seconds = (elapsed % 60).toString().padStart(2, '0');
                const timeString = `${minutes}:${seconds}`;
                
                const meetingDuration = document.getElementById('meetingDuration');
                const miniMeetingDuration = document.getElementById('miniMeetingDuration');
                if (meetingDuration) meetingDuration.textContent = timeString;
                if (miniMeetingDuration) miniMeetingDuration.textContent = timeString;
            }, 1000);
        }
        
        function stopMeetingTimer() {
            if (meetingTimer) {
                clearInterval(meetingTimer);
                meetingTimer = null;
            }
        }
        
        function endMeeting() {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën k·∫øt th√∫c cu·ªôc h·ªçp?')) {
                document.getElementById('meetingRoomModal').classList.add('hidden');
                document.getElementById('minimizedMeeting').classList.add('hidden');
                stopMeetingTimer();
                
                // Reset meeting states
                isMeetingMuted = true;
                isMeetingVideoOn = false;
                isMeetingScreenSharing = false;
                currentRoomCode = '';
            }
        }
        
        function toggleMeetingMute() {
            isMeetingMuted = !isMeetingMuted;
            const muteBtn = document.getElementById('meetingMuteBtn');
            const icon = muteBtn.querySelector('i');
            
            if (isMeetingMuted) {
                muteBtn.classList.remove('bg-gray-600');
                muteBtn.classList.add('bg-red-600');
                icon.classList.remove('fa-microphone');
                icon.classList.add('fa-microphone-slash');
            } else {
                muteBtn.classList.remove('bg-red-600');
                muteBtn.classList.add('bg-gray-600');
                icon.classList.remove('fa-microphone-slash');
                icon.classList.add('fa-microphone');
            }
        }
        
        function toggleMeetingVideo() {
            isMeetingVideoOn = !isMeetingVideoOn;
            const videoBtn = document.getElementById('meetingVideoBtn');
            const icon = videoBtn.querySelector('i');
            
            if (!isMeetingVideoOn) {
                videoBtn.classList.remove('bg-gray-600');
                videoBtn.classList.add('bg-red-600');
                icon.classList.remove('fa-video');
                icon.classList.add('fa-video-slash');
            } else {
                videoBtn.classList.remove('bg-red-600');
                videoBtn.classList.add('bg-gray-600');
                icon.classList.remove('fa-video-slash');
                icon.classList.add('fa-video');
            }
        }
        
        function toggleMeetingScreenShare() {
            isMeetingScreenSharing = !isMeetingScreenSharing;
            const btn = event.currentTarget;
            
            if (isMeetingScreenSharing) {
                btn.classList.remove('bg-gray-600');
                btn.classList.add('bg-blue-600');
                alert('ƒêang chia s·∫ª m√†n h√¨nh...');
            } else {
                btn.classList.remove('bg-blue-600');
                btn.classList.add('bg-gray-600');
                alert('ƒê√£ d·ª´ng chia s·∫ª m√†n h√¨nh');
            }
        }
        
        function inviteToMeeting() {
            document.getElementById('inviteMeetingModal').classList.remove('hidden');
        }
        
        function closeInviteMeeting() {
            document.getElementById('inviteMeetingModal').classList.add('hidden');
        }
        
        function inviteUser(userId) {
            alert(`ƒê√£ g·ª≠i l·ªùi m·ªùi tham gia cu·ªôc h·ªçp ƒë·∫øn ${userId}!`);
        }
        
        function copyMeetingLink() {
            const link = `https://meet.app/${currentRoomCode}`;
            navigator.clipboard.writeText(link).then(() => {
                alert('ƒê√£ sao ch√©p link cu·ªôc h·ªçp!');
            }).catch(() => {
                alert('Kh√¥ng th·ªÉ sao ch√©p link. Vui l√≤ng th·ª≠ l·∫°i!');
            });
        }
        
        function shareRoomCode() {
            const message = `Tham gia cu·ªôc h·ªçp c·ªßa t√¥i!\nM√£ cu·ªôc h·ªçp: ${currentRoomCode}\nLink: https://meet.app/${currentRoomCode}`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'L·ªùi m·ªùi cu·ªôc h·ªçp',
                    text: message
                });
            } else {
                navigator.clipboard.writeText(message).then(() => {
                    alert('ƒê√£ sao ch√©p th√¥ng tin cu·ªôc h·ªçp!');
                }).catch(() => {
                    alert('Kh√¥ng th·ªÉ chia s·∫ª. Vui l√≤ng th·ª≠ l·∫°i!');
                });
            }
        }
        
        function showParticipants() {
            alert('Danh s√°ch th√†nh vi√™n:\n- B·∫°n (Ch·ªß ph√≤ng)\n- Mai Nguy·ªÖn\n- ƒê·ª©c Tr·∫ßn\n- Linh V√µ');
        }
        
        function showMeetingChat() {
            alert('T√≠nh nƒÉng chat trong cu·ªôc h·ªçp s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t s·ªõm!');
        }
        
        function showMeetingSettings() {
            alert('C√†i ƒë·∫∑t cu·ªôc h·ªçp s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t s·ªõm!');
        }
        
        // New functions for enhanced features
        function answerCall() {
            document.getElementById('answerCallBtn').classList.add('hidden');
            alert('ƒê√£ tr·∫£ l·ªùi cu·ªôc g·ªçi!');
        }
        
        function showScheduleMeeting() {
            document.getElementById('scheduleMeetingModal').classList.remove('hidden');
            closeRoomModal();
        }
        
        function closeScheduleMeeting() {
            document.getElementById('scheduleMeetingModal').classList.add('hidden');
        }
        
        function scheduleMeeting() {
            alert('ƒê√£ l·∫≠p l·ªãch cu·ªôc h·ªçp th√†nh c√¥ng! Th√¥ng b√°o s·∫Ω ƒë∆∞·ª£c g·ª≠i ƒë·∫øn nh·ªØng ng∆∞·ªùi ƒë∆∞·ª£c m·ªùi.');
            closeScheduleMeeting();
        }
        
        function minimizeMeeting() {
            document.getElementById('meetingRoomModal').classList.add('hidden');
            document.getElementById('minimizedMeeting').classList.remove('hidden');
            
            // Sync timer with minimized window
            const duration = document.getElementById('meetingDuration').textContent;
            document.getElementById('miniMeetingDuration').textContent = duration;
        }
        
        function maximizeMeeting() {
            document.getElementById('minimizedMeeting').classList.add('hidden');
            document.getElementById('meetingRoomModal').classList.remove('hidden');
        }
        
        // Simulate incoming call
        function simulateIncomingCall() {
            document.getElementById('answerCallBtn').classList.remove('hidden');
            document.getElementById('voiceCallModal').classList.remove('hidden');
            
            // Auto-hide answer button after 10 seconds
            setTimeout(() => {
                document.getElementById('answerCallBtn').classList.add('hidden');
            }, 10000);
        }
        
        // Call functions
        let callTimer;
        let callStartTime;
        let isMuted = false;
        let isVideoOn = true;
        let isScreenSharing = false;
        
        function startCallTimer() {
            callStartTime = Date.now();
            callTimer = setInterval(() => {
                const elapsed = Math.floor((Date.now() - callStartTime) / 1000);
                const minutes = Math.floor(elapsed / 60).toString().padStart(2, '0');
                const seconds = (elapsed % 60).toString().padStart(2, '0');
                const timeString = `${minutes}:${seconds}`;
                
                const callDuration = document.getElementById('callDuration');
                const voiceCallDuration = document.getElementById('voiceCallDuration');
                if (callDuration) callDuration.textContent = timeString;
                if (voiceCallDuration) voiceCallDuration.textContent = timeString;
            }, 1000);
        }
        
        function stopCallTimer() {
            if (callTimer) {
                clearInterval(callTimer);
                callTimer = null;
            }
        }
        
        function toggleMute() {
            isMuted = !isMuted;
            const muteBtn = document.getElementById('muteBtn');
            const icon = muteBtn.querySelector('i');
            
            if (isMuted) {
                muteBtn.classList.remove('bg-gray-600');
                muteBtn.classList.add('bg-red-600');
                icon.classList.remove('fa-microphone');
                icon.classList.add('fa-microphone-slash');
            } else {
                muteBtn.classList.remove('bg-red-600');
                muteBtn.classList.add('bg-gray-600');
                icon.classList.remove('fa-microphone-slash');
                icon.classList.add('fa-microphone');
            }
        }
        
        function toggleVoiceMute() {
            isMuted = !isMuted;
            const muteBtn = document.getElementById('voiceMuteBtn');
            const icon = muteBtn.querySelector('i');
            
            if (isMuted) {
                muteBtn.classList.remove('bg-gray-600');
                muteBtn.classList.add('bg-red-600');
                icon.classList.remove('fa-microphone');
                icon.classList.add('fa-microphone-slash');
            } else {
                muteBtn.classList.remove('bg-red-600');
                muteBtn.classList.add('bg-gray-600');
                icon.classList.remove('fa-microphone-slash');
                icon.classList.add('fa-microphone');
            }
        }
        
        function toggleVideo() {
            isVideoOn = !isVideoOn;
            const videoBtn = document.getElementById('videoBtn');
            const icon = videoBtn.querySelector('i');
            
            if (!isVideoOn) {
                videoBtn.classList.remove('bg-gray-600');
                videoBtn.classList.add('bg-red-600');
                icon.classList.remove('fa-video');
                icon.classList.add('fa-video-slash');
            } else {
                videoBtn.classList.remove('bg-red-600');
                videoBtn.classList.add('bg-gray-600');
                icon.classList.remove('fa-video-slash');
                icon.classList.add('fa-video');
            }
        }
        
        function toggleScreenShare() {
            isScreenSharing = !isScreenSharing;
            const btn = event.currentTarget;
            
            if (isScreenSharing) {
                btn.classList.remove('bg-gray-600');
                btn.classList.add('bg-blue-600');
                alert('ƒêang chia s·∫ª m√†n h√¨nh...');
            } else {
                btn.classList.remove('bg-blue-600');
                btn.classList.add('bg-gray-600');
                alert('ƒê√£ d·ª´ng chia s·∫ª m√†n h√¨nh');
            }
        }
        
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }
        
        function switchToVideo() {
            document.getElementById('voiceCallModal').classList.add('hidden');
            document.getElementById('videoCallModal').classList.remove('hidden');
        }
        
        function showThemeModal() {
            alert('T√≠nh nƒÉng ƒë·ªïi ch·ªß ƒë·ªÅ s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t s·ªõm!');
        }
        
        function toggleDarkMode(checkbox) {
            if (checkbox.checked) {
                document.body.classList.add('dark');
                alert('Ch·∫ø ƒë·ªô t·ªëi s·∫Ω ƒë∆∞·ª£c √°p d·ª•ng trong phi√™n b·∫£n ti·∫øp theo!');
            } else {
                document.body.classList.remove('dark');
            }
        }
        
        function logout() {
            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t?')) {
                alert('ƒê√£ ƒëƒÉng xu·∫•t th√†nh c√¥ng!');
                closeSettings();
            }
        }
        
        // File handling
        function showAttachmentMenu() {
            const menu = document.getElementById('attachmentMenu');
            menu.classList.toggle('hidden');
        }
        
        function selectFile() {
            document.getElementById('fileInput').click();
            document.getElementById('attachmentMenu').classList.add('hidden');
        }
        
        function selectImage() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*,video/*';
            input.onchange = handleFileSelect;
            input.click();
            document.getElementById('attachmentMenu').classList.add('hidden');
        }
        
        function handleFileSelect(event) {
            const files = event.target.files;
            if (files.length > 0) {
                for (let file of files) {
                    sendFileMessage(file);
                }
            }
        }
        
        function sendFileMessage(file) {
            const messagesContainer = document.getElementById('messagesContainer');
            const fileIcon = getFileIcon(file.type);
            const fileSize = formatFileSize(file.size);
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'flex justify-end';
            messageDiv.innerHTML = `
                <div class="bg-blue-500 text-white rounded-2xl px-4 py-3 max-w-xs message-bubble">
                    <div class="flex items-center space-x-3">
                        <i class="fas ${fileIcon} text-2xl"></i>
                        <div>
                            <p class="font-medium">${file.name}</p>
                            <p class="text-xs opacity-75">${fileSize}</p>
                        </div>
                    </div>
                </div>
            `;
            
            const typingIndicator = document.getElementById('typingIndicator');
            messagesContainer.insertBefore(messageDiv, typingIndicator);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // Show response
            setTimeout(() => {
                showTypingIndicator();
                setTimeout(() => {
                    hideTypingIndicator();
                    addResponseMessage('ƒê√£ nh·∫≠n t√†i li·ªáu! üìÑ');
                }, 2000);
            }, 500);
        }
        
        function getFileIcon(fileType) {
            if (fileType.startsWith('image/')) return 'fa-image';
            if (fileType.startsWith('video/')) return 'fa-video';
            if (fileType.includes('pdf')) return 'fa-file-pdf';
            if (fileType.includes('word')) return 'fa-file-word';
            if (fileType.includes('excel') || fileType.includes('spreadsheet')) return 'fa-file-excel';
            return 'fa-file';
        }
        
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        function createPoll() {
            alert('T√≠nh nƒÉng b√¨nh ch·ªçn s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t s·ªõm!');
            document.getElementById('attachmentMenu').classList.add('hidden');
        }
        
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }
        
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (message) {
                const messagesContainer = document.getElementById('messagesContainer');
                
                // Create new message element
                const messageDiv = document.createElement('div');
                messageDiv.className = 'flex justify-end';
                messageDiv.innerHTML = `
                    <div class="bg-blue-500 text-white rounded-2xl px-4 py-2 max-w-xs message-bubble">
                        <p>${message}</p>
                    </div>
                `;
                
                // Insert before typing indicator
                const typingIndicator = document.getElementById('typingIndicator');
                messagesContainer.insertBefore(messageDiv, typingIndicator);
                
                // Clear input
                input.value = '';
                
                // Scroll to bottom
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
                
                // Show typing indicator after a delay
                setTimeout(() => {
                    showTypingIndicator();
                    setTimeout(() => {
                        hideTypingIndicator();
                        // Add a response message
                        addResponseMessage();
                    }, 2000);
                }, 500);
            }
        }
        
        function addResponseMessage(customMessage = null) {
            const responses = [
                "C·∫£m ∆°n b·∫°n! üòä",
                "M√¨nh hi·ªÉu r·ªìi!",
                "√ù ki·∫øn hay ƒë·∫•y! üëç",
                "ƒê∆∞·ª£c th√¥i, m√¨nh s·∫Ω suy nghƒ© v·ªÅ ƒëi·ªÅu ƒë√≥",
                "Haha, b·∫°n vui qu√°! üòÑ"
            ];
            
            const randomResponse = customMessage || responses[Math.floor(Math.random() * responses.length)];
            const messagesContainer = document.getElementById('messagesContainer');
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'flex justify-start';
            messageDiv.innerHTML = `
                <div class="flex items-end space-x-2 max-w-xs">
                    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='28' viewBox='0 0 28 28'%3E%3Ccircle cx='14' cy='14' r='14' fill='%23FF6B9D'/%3E%3Ctext x='14' y='18' text-anchor='middle' fill='white' font-size='12' font-weight='bold'%3EM%3C/text%3E%3C/svg%3E" 
                         alt="Mai" class="w-7 h-7 rounded-full">
                    <div class="bg-gray-200 rounded-2xl px-4 py-2 message-bubble">
                        <p class="text-gray-800">${randomResponse}</p>
                    </div>
                </div>
            `;
            
            const typingIndicator = document.getElementById('typingIndicator');
            messagesContainer.insertBefore(messageDiv, typingIndicator);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        function showTypingIndicator() {
            document.getElementById('typingIndicator').classList.remove('hidden');
            document.getElementById('messagesContainer').scrollTop = document.getElementById('messagesContainer').scrollHeight;
        }
        
        function hideTypingIndicator() {
            document.getElementById('typingIndicator').classList.add('hidden');
        }
        
        function startVideoCall() {
            document.getElementById('videoCallModal').classList.remove('hidden');
            startCallTimer();
            closeChatInfo();
        }
        
        function startVoiceCall() {
            document.getElementById('voiceCallModal').classList.remove('hidden');
            startCallTimer();
            closeChatInfo();
        }
        
        function endCall() {
            document.getElementById('videoCallModal').classList.add('hidden');
            document.getElementById('voiceCallModal').classList.add('hidden');
            stopCallTimer();
            
            // Reset call states
            isMuted = false;
            isVideoOn = true;
            isScreenSharing = false;
        }
        
        function showSettings() {
            document.getElementById('settingsModal').classList.remove('hidden');
        }
        
        function closeSettings() {
            document.getElementById('settingsModal').classList.add('hidden');
        }
        
        function showChatInfo() {
            // Update chat info modal with current chat data
            const chatData = {
                'mai': {
                    name: 'Mai Nguy·ªÖn',
                    avatar: 'M',
                    color: '#FF6B9D',
                    status: 'ƒêang ho·∫°t ƒë·ªông'
                },
                'duc': {
                    name: 'ƒê·ª©c Tr·∫ßn',
                    avatar: 'D',
                    color: '#4A90E2',
                    status: 'Ho·∫°t ƒë·ªông 5 ph√∫t tr∆∞·ªõc'
                },
                'linh': {
                    name: 'Linh V√µ',
                    avatar: 'L',
                    color: '#F39C12',
                    status: 'Ho·∫°t ƒë·ªông 1 gi·ªù tr∆∞·ªõc'
                }
            };
            
            const chat = chatData[currentChat];
            if (chat) {
                document.getElementById('chatInfoName').textContent = chat.name;
                document.getElementById('chatInfoStatus').textContent = chat.status;
                
                const avatarSvg = `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Ccircle cx='40' cy='40' r='40' fill='${encodeURIComponent(chat.color)}'/%3E%3Ctext x='40' y='50' text-anchor='middle' fill='white' font-size='32' font-weight='bold'%3E${chat.avatar}%3C/text%3E%3C/svg%3E`;
                document.getElementById('chatInfoAvatar').src = avatarSvg;
            }
            
            document.getElementById('chatInfoModal').classList.remove('hidden');
        }
        
        function closeChatInfo() {
            document.getElementById('chatInfoModal').classList.add('hidden');
        }
        
        // Close modals and menus when clicking outside
        document.addEventListener('click', function(event) {
            const modals = ['settingsModal', 'chatInfoModal', 'newChatModal', 'roomModal'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (event.target === modal) {
                    modal.classList.add('hidden');
                }
            });
            
            // Close attachment menu when clicking outside
            const attachmentMenu = document.getElementById('attachmentMenu');
            if (!event.target.closest('#attachmentMenu') && !event.target.closest('button[onclick="showAttachmentMenu()"]')) {
                attachmentMenu.classList.add('hidden');
            }
        });
        
        // Drag and drop file upload
        document.addEventListener('DOMContentLoaded', function() {
            const messagesContainer = document.getElementById('messagesContainer');
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // Drag and drop functionality
            const chatArea = document.querySelector('.flex-1.flex.flex-col');
            
            chatArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                document.getElementById('fileUploadArea').classList.remove('hidden');
            });
            
            chatArea.addEventListener('dragleave', function(e) {
                if (!chatArea.contains(e.relatedTarget)) {
                    document.getElementById('fileUploadArea').classList.add('hidden');
                }
            });
            
            chatArea.addEventListener('drop', function(e) {
                e.preventDefault();
                document.getElementById('fileUploadArea').classList.add('hidden');
                
                const files = e.dataTransfer.files;
                for (let file of files) {
                    sendFileMessage(file);
                }
            });
        });
        
        // Keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            // Ctrl/Cmd + K to focus search
            if ((event.ctrlKey || event.metaKey) && event.key === 'k') {
                event.preventDefault();
                document.getElementById('searchInput').focus();
            }
            
            // Escape to close modals and search
            if (event.key === 'Escape') {
                document.querySelectorAll('.fixed.inset-0').forEach(modal => {
                    modal.classList.add('hidden');
                });
                closeChatSearch();
                document.getElementById('attachmentMenu').classList.add('hidden');
            }
        }); 
function toggleChatInfoPanel() {
  const panel = document.getElementById('chatInfoPanel');
  const main  = document.getElementById('mainChatArea');

  panel.classList.toggle('open');
  if (panel.classList.contains('open')) {
    main.classList.add('pr-[320px]');
    // lu√¥n ƒë·ªìng b·ªô n·ªôi dung theo cu·ªôc tr√≤ chuy·ªán ƒëang xem
    renderInfo(CURRENT_THREAD);
  } else {
    main.classList.remove('pr-[320px]');
  }
}

</script>
<script>
/* ==== 1) Data threads: m·ªói id l√† m·ªôt cu·ªôc tr√≤ chuy·ªán ==== */
const THREADS = {
  mai: {
    name: "Mai Nguy·ªÖn",
    avatar: svgAvatar("M", "#FF6B9D"),
    status: { text: "ƒêang ho·∫°t ƒë·ªông", color: "text-green-600" },
    messages: [
      { from: "other", text: "Ch√†o b·∫°n! H√¥m nay th·∫ø n√†o? üòä" },
      { from: "me",    text: "Ch√†o Mai! M√¨nh ·ªïn, c·∫£m ∆°n b·∫°n. C√≤n b·∫°n th√¨ sao?" },
      { from: "other", text: "M√¨nh c≈©ng t·ªët! Ng√†y mai c√≥ r·∫£nh kh√¥ng? M√¨nh m·ªùi c√† ph√™ ‚òï" },
      { from: "me",    text: "√ù t∆∞·ªüng hay ƒë·∫•y! M·∫•y gi·ªù nh·ªâ?" },
      { from: "other", text: "2 gi·ªù chi·ªÅu ƒë∆∞·ª£c kh√¥ng? Qu√°n g·∫ßn tr∆∞·ªùng c≈© üìç" },
      { from: "me",    text: "Oke, h·∫πn g·∫∑p l·∫°i nh√©! üëã" }
    ]
  },

  duc: {
    name: "ƒê·ª©c Tr·∫ßn",
    avatar: svgAvatar("D", "#4A90E2"),
    status: { text: "V·ª´a ho·∫°t ƒë·ªông", color: "text-gray-500" },
    messages: [
      { from: "other", text: "H√¥m nay c√≥ r·∫£nh kh√¥ng? ü§î" },    { from: "other", text: "Ok, ƒë·ªÉ m√¨nh g·ª≠i file Google Docs." },
    { from: "me", text: "C·ª©u tinh c·ªßa ƒë·ªùi m√¨nh üôè" },
    { from: "other", text: "Haha, h·ªçc chung m·ªõi vui ch·ª©!" },
    { from: "me", text: "T·ªëi call h·ªçc nh√≥m ƒëi." },
    { from: "other", text: "Qu√° chu·∫©n, 8h nh√©!" },
      { from: "me",    text: "Chi·ªÅu t·ªõ b·∫≠n, t·ªëi 8h ƒë∆∞·ª£c ch·ª©?" },
      { from: "other", text: "Ok nh√©!" }
    ]
  },

  linh: {
    name: "Linh V√µ",
    avatar: svgAvatar("L", "#F39C12"),
    status: { text: "Ngo·∫°i tuy·∫øn", color: "text-gray-400" },
    messages: [
      { from: "me",    text: "C·∫£m ∆°n b·∫°n nhi·ªÅu! ‚ù§Ô∏è" },    { from: "other", text: "Ok, ƒë·ªÉ m√¨nh g·ª≠i file Google Docs." },
    { from: "me", text: "C·ª©u tinh c·ªßa ƒë·ªùi m√¨nh üôè" },

      { from: "other", text: "Kh√¥ng c√≥ g√¨ n√®!" }
    ]
  },

  group: {
    name: "Nh√≥m B·∫°n Th√¢n",
    avatar: svgAvatar("Nh√≥m", "#9B59B6"),
    status: { text: "5 th√†nh vi√™n", color: "text-gray-500" },
    messages: [
      { from: "other", sender:"An", text: "Ai ƒëi xem phim kh√¥ng? üé¨" },
      { from: "me",    text: "T·ªõ ƒëi!" },
   { from: "other", text: "Ok, ƒë·ªÉ m√¨nh g·ª≠i file Google Docs." },
    { from: "me", text: "C·ª©u tinh c·ªßa ƒë·ªùi m√¨nh üôè" },
    { from: "other", text: "Haha, h·ªçc chung m·ªõi vui ch·ª©!" },
    { from: "me", text: "T·ªëi call h·ªçc nh√≥m ƒëi." },
    { from: "other", text: "Qu√° chu·∫©n, 8h nh√©!" },
    ]
  },hoa: {
  name: "Hoa Ph·∫°m",
  avatar: svgAvatar("H", "#E91E63"),
  status: { text: "ƒêang g√µ‚Ä¶", color: "text-green-500" },
  messages: [
    { from: "other", text: "Mai thi ch∆∞a √¥n g√¨ lu√¥n üòÖ" },
    { from: "me", text: "√îi, ƒëang c√†y ƒë√¢y. B·∫°n √¥n t·ªõi ƒë√¢u r·ªìi?" },
    { from: "other", text: "M√¨nh m·ªõi l√†m ƒë·ªÅ c∆∞∆°ng xong, stress qu√°!" },
    { from: "me", text: "Chia s·∫ª cho m√¨nh v·ªõi, m√¨nh l√†m b√†i t·∫≠p m√£i ch∆∞a xong." },
   
    { from: "other", text: "Haha, h·ªçc chung m·ªõi vui ch·ª©!" },
    { from: "me", text: "T·ªëi call h·ªçc nh√≥m ƒëi." },
    { from: "other", text: "Qu√° chu·∫©n, 8h nh√©!" },
  ]
},


  // ‚Ä¶ th√™m c√°c thread kh√°c t∆∞∆°ng t·ª±: an, hoa, work, nam, family, study, gaming, ...
};

/* (tu·ª≥ ch·ªçn) L∆∞u draft theo t·ª´ng thread */
const DRAFTS = new Map();

/* ==== 2) Helper t·∫°o avatar SVG ==== */
function svgAvatar(text, color){
  const enc = encodeURIComponent;
  return `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'%3E%3Ccircle cx='40' cy='40' r='40' fill='${enc(color)}'/%3E%3Ctext x='40' y='50' text-anchor='middle' fill='white' font-size='32' font-weight='bold'%3E${enc(text)}%3C/text%3E%3C/svg%3E`;
}

/* ==== 3) Render header + messages + panel ==== */
function renderThread(threadId){
  const t = THREADS[threadId];
  if(!t) return;

  // Header
  document.getElementById('chatAvatar').src  = t.avatar;
  document.getElementById('chatName').textContent = t.name;
  const statusEl = document.getElementById('chatStatus');
  statusEl.className = `text-sm ${t.status.color}`;
  statusEl.textContent = t.status.text;

  // Panel info (khi m·ªü)
  const pName   = document.getElementById('panelChatName');
  const pStatus = document.getElementById('panelChatStatus');
  const pAvatar = document.getElementById('panelChatAvatar');
  if (pName)   pName.textContent = t.name;
  if (pStatus) { pStatus.className = `${t.status.color} text-sm`; pStatus.textContent = t.status.text; }
  if (pAvatar) pAvatar.src = t.avatar;

  // Messages
  const box = document.getElementById('messagesContainer');
  box.innerHTML = t.messages.map(m => {
    if(m.from === 'me'){
      return `
        <div class="flex justify-end">
          <div class="bg-blue-500 text-white rounded-2xl px-4 py-2 max-w-xs message-bubble">
            <p>${escapeHTML(m.text)}</p>
          </div>
        </div>`;
    } else {
      const senderChip = m.sender ? `<span class="text-xs text-gray-500 block mb-0.5">${escapeHTML(m.sender)}</span>` : "";
      return `
        <div class="flex justify-start">
          <div class="flex items-end space-x-2 max-w-xs">
            <img src="${t.avatar.replace("80","28")}" class="w-7 h-7 rounded-full" alt="">
            <div class="bg-gray-200 rounded-2xl px-4 py-2 message-bubble">
              ${senderChip}<p class="text-gray-800">${escapeHTML(m.text)}</p>
            </div>
          </div>
        </div>`;
    }
  }).join("");

  // Scroll ƒë√°y
  box.scrollTop = box.scrollHeight + 1000;

  // Kh√¥i ph·ª•c draft (n·∫øu c√≥)
  const input = document.getElementById('messageInput');
  input.value = DRAFTS.get(threadId) || "";
}
function renderInfo(threadId){
  const t = THREADS[threadId];
  if(!t) return;

  // header c·ªßa panel
  document.getElementById('panelChatName').textContent  = t.name;
  const statusEl = document.getElementById('panelChatStatus');
  statusEl.className = `${t.status.color} text-sm`;
  statusEl.textContent = t.status.text;
  document.getElementById('panelChatAvatar').src = t.avatar;

  // th√¢n panel
  const info = t.info || {};
  const panel = document.getElementById('panelInfoBody');
  if(!panel) return;

  const about = info.about ? `
    <section class="bg-gray-50 border border-gray-200 rounded-lg p-3">
      <h4 class="text-sm font-semibold text-gray-800 mb-1">Gi·ªõi thi·ªáu</h4>
      <p class="text-sm text-gray-700 leading-6">${escapeHTML(info.about)}</p>
    </section>` : "";

  const contact = (info.phone || info.email) ? `
    <section class="bg-white border border-gray-200 rounded-lg p-3">
      <h4 class="text-sm font-semibold text-gray-800 mb-2">Li√™n h·ªá</h4>
      ${info.phone ? `<div class="text-sm text-gray-700"><i class="fa fa-phone mr-2 text-gray-500"></i>${escapeHTML(info.phone)}</div>` : ""}
      ${info.email ? `<div class="text-sm text-gray-700 mt-1"><i class="fa fa-envelope mr-2 text-gray-500"></i>${escapeHTML(info.email)}</div>` : ""}
    </section>` : "";

  const members = Array.isArray(info.members) ? `
    <section class="bg-white border border-gray-200 rounded-lg p-3">
      <h4 class="text-sm font-semibold text-gray-800 mb-2">Th√†nh vi√™n (${info.members.length})</h4>
      <ul class="space-y-1">
        ${info.members.map(m => `
          <li class="text-sm text-gray-700 flex items-center gap-2">
            <span class="w-1.5 h-1.5 rounded-full ${m.me ? 'bg-blue-500' : 'bg-gray-300'}"></span>
            ${escapeHTML(m.name)}${m.me ? " <span class='ml-1 text-xs text-blue-500'>(B·∫°n)</span>" : ""}
          </li>`).join("")}
      </ul>
    </section>` : "";

  const files = Array.isArray(info.files) && info.files.length ? `
    <section class="bg-white border border-gray-200 rounded-lg p-3">
      <h4 class="text-sm font-semibold text-gray-800 mb-2">T·ªáp ƒë√£ chia s·∫ª</h4>
      <ul class="space-y-2">
        ${info.files.map(f => `
          <li class="text-sm text-gray-700 flex items-center gap-2">
            <i class="fa fa-file text-gray-400"></i>
            <a class="text-blue-600 hover:underline" href="${f.url || '#'}">${escapeHTML(f.name)}</a>
          </li>`).join("")}
      </ul>
    </section>` : "";

  panel.innerHTML = [about, contact, members, files].filter(Boolean).join('<div class="h-3"></div>');
}

/* ==== 4) Ch·ªçn thread t·ª´ list ==== */
let CURRENT_THREAD = 'mai';
function selectChat(idOrEl){
  const id = typeof idOrEl === 'string' ? idOrEl : (idOrEl.dataset?.id || idOrEl.getAttribute('data-id'));
  if(!id || !THREADS[id]) return;

  // L∆∞u draft thread c≈©
  const input = document.getElementById('messageInput');
  if (window.CURRENT_THREAD) DRAFTS.set(CURRENT_THREAD, input.value);

  window.CURRENT_THREAD = id;

  renderThread(id);   // 1. c·∫≠p nh·∫≠t tin nh·∫Øn, header, panel info header
  renderInfo(id);     // 2. c·∫≠p nh·∫≠t n·ªôi dung panel (b·∫Øt bu·ªôc G·ªåI NGAY ·ªû ƒê√ÇY!)

  // Active UI cho item list (n·∫øu c√≥)
  document.querySelectorAll('#chatList .chat-item').forEach(it => {
    it.classList.remove('active');
  });
  const activeEl = document.querySelector(`#chatList .chat-item[data-id="${id}"]`)
                 || document.querySelector(`#chatList .chat-item[onclick*="${id}"]`);
  activeEl?.classList.add('active');
}


/* ==== 5) G·ª≠i tin g·∫Øn v·ªõi thread hi·ªán t·∫°i ==== */
function sendMessage(){
  const input = document.getElementById('messageInput');
  const text  = (input.value || "").trim();
  if(!text || !CURRENT_THREAD) return;

  // L∆∞u v√†o data
  THREADS[CURRENT_THREAD].messages.push({ from:'me', text });

  // Render nhanh ph·∫ßn cu·ªëi + scroll
  const box = document.getElementById('messagesContainer');
  box.insertAdjacentHTML('beforeend', `
    <div class="flex justify-end">
      <div class="bg-blue-500 text-white rounded-2xl px-4 py-2 max-w-xs message-bubble">
        <p>${escapeHTML(text)}</p>
      </div>
    </div>`);
  box.scrollTop = box.scrollHeight + 1000;

  input.value = "";
  DRAFTS.set(CURRENT_THREAD, "");
}

/* ==== 6) Event kh·ªüi t·∫°o & ti·ªán √≠ch ==== */
document.addEventListener('DOMContentLoaded', () => {
  // ·ª¶y quy·ªÅn s·ª± ki·ªán cho tr∆∞·ªùng h·ª£p d√πng data-id
  document.getElementById('chatList')?.addEventListener('click', (e) => {
    const item = e.target.closest('.chat-item');
    if(item && item.dataset.id){ selectChat(item); }
  });

  // Thread m·∫∑c ƒë·ªãnh
  selectChat(CURRENT_THREAD);
});

function escapeHTML(s){ return s.replace(/[&<>"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c])); }
</script>

<script defer src="/assets/js/loading.js"></script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97536e0cf518097c',t:'MTc1NjIxMjM2NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
